{"version":3,"file":"tours-sdk.min.js","sources":["../src/sdk/tours/utils/api.js","../src/sdk/tours/utils/storage.js","../src/sdk/tours/TourEngine.js","../src/sdk/tours/utils/positioning.js","../src/sdk/tours/components/Tooltip.js","../src/sdk/tours/components/Modal.js","../src/sdk/tours/components/Hotspot.js","../src/sdk/tours/components/Slideout.js","../src/sdk/tours/components/Overlay.js","../src/sdk/tours/components/ProgressBar.js","../src/sdk/tours/utils/dom.js","../src/sdk/tours/TourRenderer.js","../src/sdk/tours/utils/events.js","../src/sdk/tours/TourSDK.js","../src/sdk/tours/index.js"],"sourcesContent":["/**\n * API Utilities\n * Handles communication with the BotBuilder Tours API\n */\n\nlet API_URL = 'https://api.botbuilder.app';\nlet WORKSPACE_ID = null;\n\n/**\n * Initialize API configuration\n * @param {string} apiUrl - API base URL\n * @param {string} workspaceId - Workspace ID\n */\nexport function initApi(apiUrl, workspaceId) {\n  API_URL = apiUrl;\n  WORKSPACE_ID = workspaceId;\n}\n\n/**\n * Make an API request\n * @param {string} endpoint - API endpoint\n * @param {Object} options - Fetch options\n * @returns {Promise<Object>}\n */\nasync function request(endpoint, options = {}) {\n  const url = `${API_URL}${endpoint}`;\n\n  const defaultHeaders = {\n    'Content-Type': 'application/json',\n    'X-Workspace-ID': WORKSPACE_ID,\n  };\n\n  try {\n    const response = await fetch(url, {\n      ...options,\n      headers: {\n        ...defaultHeaders,\n        ...options.headers,\n      },\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      throw new Error(errorData.message || `HTTP ${response.status}`);\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error(`[TourSDK API] Request failed: ${endpoint}`, error);\n    throw error;\n  }\n}\n\n/**\n * Initialize session and fetch active tours\n * @param {string} workspaceId - Workspace ID\n * @param {Object} options - Options\n * @returns {Promise<Object>}\n */\nexport async function initSession(workspaceId, options = {}) {\n  const { visitorId, userId } = options;\n\n  return request('/api/public/tours/init', {\n    method: 'POST',\n    body: JSON.stringify({\n      workspaceId,\n      visitorId,\n      userId,\n      url: window.location.href,\n      referrer: document.referrer,\n      userAgent: navigator.userAgent,\n      timestamp: new Date().toISOString(),\n    }),\n  });\n}\n\n/**\n * Fetch active tours for a workspace\n * @param {string} workspaceId - Workspace ID\n * @param {Object} options - Options\n * @returns {Promise<Array>}\n */\nexport async function fetchActiveTours(workspaceId, options = {}) {\n  const { visitorId, userId } = options;\n\n  const params = new URLSearchParams({\n    workspaceId,\n    url: window.location.pathname,\n  });\n\n  if (visitorId) params.append('visitorId', visitorId);\n  if (userId) params.append('userId', userId);\n\n  const response = await request(`/api/public/tours?${params.toString()}`);\n  return response.tours || [];\n}\n\n/**\n * Fetch a specific tour\n * @param {string} tourId - Tour ID\n * @returns {Promise<Object>}\n */\nexport async function fetchTour(tourId) {\n  const response = await request(`/api/public/tours/${tourId}`);\n  return response.tour || response;\n}\n\n/**\n * Track an analytics event\n * @param {Object} eventData - Event data\n * @returns {Promise}\n */\nexport async function trackEvent(eventData) {\n  const payload = {\n    ...eventData,\n    workspaceId: WORKSPACE_ID,\n    timestamp: eventData.timestamp || new Date().toISOString(),\n    sessionId: getSessionId(),\n    pageUrl: window.location.href,\n    pageTitle: document.title,\n  };\n\n  // Use sendBeacon for reliability (especially on page unload)\n  if (navigator.sendBeacon) {\n    const blob = new Blob([JSON.stringify(payload)], { type: 'application/json' });\n    navigator.sendBeacon(`${API_URL}/api/public/tours/event`, blob);\n    return;\n  }\n\n  // Fallback to fetch\n  return request('/api/public/tours/event', {\n    method: 'POST',\n    body: JSON.stringify(payload),\n  });\n}\n\n/**\n * Sync progress with server\n * @param {Object} progressData - Progress data\n * @returns {Promise}\n */\nexport async function syncProgress(progressData) {\n  return request('/api/public/tours/progress', {\n    method: 'POST',\n    body: JSON.stringify({\n      ...progressData,\n      workspaceId: WORKSPACE_ID,\n    }),\n  });\n}\n\n/**\n * Get user progress from server\n * @param {string} tourId - Tour ID\n * @param {string} visitorId - Visitor ID\n * @returns {Promise<Object>}\n */\nexport async function fetchProgress(tourId, visitorId) {\n  const params = new URLSearchParams({\n    tourId,\n    visitorId,\n  });\n\n  return request(`/api/public/tours/progress?${params.toString()}`);\n}\n\n/**\n * Batch track multiple events\n * @param {Array} events - Array of event data\n * @returns {Promise}\n */\nexport async function batchTrackEvents(events) {\n  return request('/api/public/tours/events/batch', {\n    method: 'POST',\n    body: JSON.stringify({\n      events,\n      workspaceId: WORKSPACE_ID,\n    }),\n  });\n}\n\n/**\n * Report an error\n * @param {Object} errorData - Error data\n * @returns {Promise}\n */\nexport async function reportError(errorData) {\n  try {\n    return request('/api/public/tours/error', {\n      method: 'POST',\n      body: JSON.stringify({\n        ...errorData,\n        workspaceId: WORKSPACE_ID,\n        url: window.location.href,\n        userAgent: navigator.userAgent,\n        timestamp: new Date().toISOString(),\n      }),\n    });\n  } catch (error) {\n    // Silently fail - don't want error reporting to cause more errors\n    console.error('[TourSDK] Failed to report error:', error);\n  }\n}\n\n// Session management\n\nlet sessionId = null;\n\nfunction getSessionId() {\n  if (!sessionId) {\n    sessionId = `s_${Date.now().toString(36)}_${Math.random().toString(36).substring(2, 8)}`;\n  }\n  return sessionId;\n}\n\n/**\n * Event queue for offline support\n */\nconst eventQueue = [];\nlet isOnline = navigator.onLine;\n\n// Monitor online status\nif (typeof window !== 'undefined') {\n  window.addEventListener('online', () => {\n    isOnline = true;\n    flushEventQueue();\n  });\n\n  window.addEventListener('offline', () => {\n    isOnline = false;\n  });\n}\n\n/**\n * Queue an event for later sending\n * @param {Object} eventData\n */\nexport function queueEvent(eventData) {\n  eventQueue.push({\n    ...eventData,\n    queuedAt: new Date().toISOString(),\n  });\n\n  // Try to flush immediately if online\n  if (isOnline) {\n    flushEventQueue();\n  }\n}\n\n/**\n * Flush the event queue\n */\nasync function flushEventQueue() {\n  if (eventQueue.length === 0 || !isOnline) return;\n\n  const events = [...eventQueue];\n  eventQueue.length = 0;\n\n  try {\n    await batchTrackEvents(events);\n  } catch (error) {\n    // Re-queue failed events\n    eventQueue.push(...events);\n    console.error('[TourSDK] Failed to flush event queue:', error);\n  }\n}\n\n// Flush queue before page unload\nif (typeof window !== 'undefined') {\n  window.addEventListener('beforeunload', () => {\n    if (eventQueue.length > 0 && navigator.sendBeacon) {\n      const blob = new Blob(\n        [JSON.stringify({ events: eventQueue, workspaceId: WORKSPACE_ID })],\n        { type: 'application/json' }\n      );\n      navigator.sendBeacon(`${API_URL}/api/public/tours/events/batch`, blob);\n    }\n  });\n}\n","/**\n * Storage Utilities\n * Handles localStorage operations for visitor ID and progress\n */\n\nconst STORAGE_PREFIX = 'bbt_tours_';\nconst VISITOR_ID_KEY = `${STORAGE_PREFIX}visitor_id`;\nconst PROGRESS_KEY = `${STORAGE_PREFIX}progress_`;\nconst SESSION_KEY = `${STORAGE_PREFIX}session`;\n\n/**\n * Generate a unique visitor ID\n * @returns {string}\n */\nfunction generateVisitorId() {\n  const timestamp = Date.now().toString(36);\n  const randomPart = Math.random().toString(36).substring(2, 10);\n  return `v_${timestamp}_${randomPart}`;\n}\n\n/**\n * Get or generate visitor ID\n * @returns {string}\n */\nexport function getVisitorId() {\n  try {\n    let visitorId = localStorage.getItem(VISITOR_ID_KEY);\n\n    if (!visitorId) {\n      visitorId = generateVisitorId();\n      localStorage.setItem(VISITOR_ID_KEY, visitorId);\n    }\n\n    return visitorId;\n  } catch (error) {\n    // localStorage might be disabled\n    console.warn('[TourSDK] localStorage not available, using session visitor ID');\n    return generateVisitorId();\n  }\n}\n\n/**\n * Set visitor ID\n * @param {string} visitorId\n */\nexport function setVisitorId(visitorId) {\n  try {\n    localStorage.setItem(VISITOR_ID_KEY, visitorId);\n  } catch (error) {\n    console.warn('[TourSDK] Failed to save visitor ID');\n  }\n}\n\n/**\n * Get progress for a tour\n * @param {string} tourId\n * @returns {Object|null}\n */\nexport function getProgress(tourId) {\n  try {\n    const data = localStorage.getItem(`${PROGRESS_KEY}${tourId}`);\n    return data ? JSON.parse(data) : null;\n  } catch (error) {\n    console.warn('[TourSDK] Failed to get progress');\n    return null;\n  }\n}\n\n/**\n * Set progress for a tour\n * @param {string} tourId\n * @param {Object} data\n */\nexport function setProgress(tourId, data) {\n  try {\n    localStorage.setItem(`${PROGRESS_KEY}${tourId}`, JSON.stringify(data));\n  } catch (error) {\n    console.warn('[TourSDK] Failed to save progress');\n  }\n}\n\n/**\n * Clear progress for a tour\n * @param {string} tourId\n */\nexport function clearProgress(tourId) {\n  try {\n    localStorage.removeItem(`${PROGRESS_KEY}${tourId}`);\n  } catch (error) {\n    console.warn('[TourSDK] Failed to clear progress');\n  }\n}\n\n/**\n * Clear all tour progress\n */\nexport function clearAllProgress() {\n  try {\n    const keys = Object.keys(localStorage);\n    keys.forEach((key) => {\n      if (key.startsWith(PROGRESS_KEY)) {\n        localStorage.removeItem(key);\n      }\n    });\n  } catch (error) {\n    console.warn('[TourSDK] Failed to clear all progress');\n  }\n}\n\n/**\n * Get all tour progress\n * @returns {Object}\n */\nexport function getAllProgress() {\n  try {\n    const progress = {};\n    const keys = Object.keys(localStorage);\n\n    keys.forEach((key) => {\n      if (key.startsWith(PROGRESS_KEY)) {\n        const tourId = key.replace(PROGRESS_KEY, '');\n        const data = localStorage.getItem(key);\n        if (data) {\n          progress[tourId] = JSON.parse(data);\n        }\n      }\n    });\n\n    return progress;\n  } catch (error) {\n    console.warn('[TourSDK] Failed to get all progress');\n    return {};\n  }\n}\n\n/**\n * Get session data\n * @returns {Object}\n */\nexport function getSession() {\n  try {\n    const data = sessionStorage.getItem(SESSION_KEY);\n    return data ? JSON.parse(data) : {};\n  } catch (error) {\n    return {};\n  }\n}\n\n/**\n * Set session data\n * @param {Object} data\n */\nexport function setSession(data) {\n  try {\n    const existing = getSession();\n    sessionStorage.setItem(SESSION_KEY, JSON.stringify({ ...existing, ...data }));\n  } catch (error) {\n    console.warn('[TourSDK] Failed to save session data');\n  }\n}\n\n/**\n * Clear session data\n */\nexport function clearSession() {\n  try {\n    sessionStorage.removeItem(SESSION_KEY);\n  } catch (error) {\n    console.warn('[TourSDK] Failed to clear session');\n  }\n}\n\n/**\n * Check if a tour has been completed\n * @param {string} tourId\n * @returns {boolean}\n */\nexport function isTourCompleted(tourId) {\n  const progress = getProgress(tourId);\n  return progress?.status === 'completed';\n}\n\n/**\n * Check if a tour has been skipped\n * @param {string} tourId\n * @returns {boolean}\n */\nexport function isTourSkipped(tourId) {\n  const progress = getProgress(tourId);\n  return progress?.status === 'skipped';\n}\n\n/**\n * Get the current step for a tour\n * @param {string} tourId\n * @returns {number}\n */\nexport function getCurrentStep(tourId) {\n  const progress = getProgress(tourId);\n  return progress?.currentStep ?? 0;\n}\n\n/**\n * Mark a tour as seen (started at least once)\n * @param {string} tourId\n */\nexport function markTourAsSeen(tourId) {\n  const progress = getProgress(tourId) || {};\n  setProgress(tourId, {\n    ...progress,\n    seen: true,\n    seenAt: new Date().toISOString(),\n  });\n}\n\n/**\n * Check if a tour has been seen\n * @param {string} tourId\n * @returns {boolean}\n */\nexport function hasTourBeenSeen(tourId) {\n  const progress = getProgress(tourId);\n  return !!progress?.seen;\n}\n\n/**\n * Store dismissed tours for the session\n * @param {string} tourId\n */\nexport function dismissTourForSession(tourId) {\n  const session = getSession();\n  const dismissed = session.dismissed || [];\n\n  if (!dismissed.includes(tourId)) {\n    dismissed.push(tourId);\n    setSession({ dismissed });\n  }\n}\n\n/**\n * Check if a tour is dismissed for this session\n * @param {string} tourId\n * @returns {boolean}\n */\nexport function isTourDismissedForSession(tourId) {\n  const session = getSession();\n  return session.dismissed?.includes(tourId) || false;\n}\n\n/**\n * Get storage usage info\n * @returns {Object}\n */\nexport function getStorageInfo() {\n  try {\n    let totalSize = 0;\n    let tourDataSize = 0;\n\n    for (const key in localStorage) {\n      if (localStorage.hasOwnProperty(key)) {\n        const size = localStorage[key].length * 2; // UTF-16\n        totalSize += size;\n\n        if (key.startsWith(STORAGE_PREFIX)) {\n          tourDataSize += size;\n        }\n      }\n    }\n\n    return {\n      totalSize,\n      tourDataSize,\n      totalSizeKB: (totalSize / 1024).toFixed(2),\n      tourDataSizeKB: (tourDataSize / 1024).toFixed(2),\n    };\n  } catch (error) {\n    return { error: 'Unable to calculate storage info' };\n  }\n}\n","/**\n * TourEngine - Handles tour logic, targeting, and API communication\n */\n\nimport { fetchActiveTours, fetchTour, trackEvent as apiTrackEvent, syncProgress } from './utils/api';\nimport { getProgress, setProgress } from './utils/storage';\n\nexport class TourEngine {\n  constructor(sdk) {\n    this.sdk = sdk;\n    this.toursCache = new Map();\n    this.activeToursCache = null;\n    this.lastFetch = 0;\n    this.cacheDuration = 5 * 60 * 1000; // 5 minutes\n  }\n\n  /**\n   * Load all active tours for the workspace\n   */\n  async loadActiveTours() {\n    const now = Date.now();\n\n    // Use cache if valid\n    if (this.activeToursCache && now - this.lastFetch < this.cacheDuration) {\n      return this.activeToursCache;\n    }\n\n    try {\n      const tours = await fetchActiveTours(this.sdk.config.workspaceId, {\n        visitorId: this.sdk.visitorId,\n        userId: this.sdk.userId,\n      });\n\n      this.activeToursCache = tours;\n      this.lastFetch = now;\n\n      // Cache individual tours\n      tours.forEach((tour) => {\n        this.toursCache.set(tour.id, tour);\n      });\n\n      return tours;\n    } catch (error) {\n      console.error('[TourEngine] Failed to load active tours:', error);\n      return [];\n    }\n  }\n\n  /**\n   * Load a specific tour by ID\n   * @param {string} tourId - Tour ID\n   */\n  async loadTour(tourId) {\n    // Check cache first\n    if (this.toursCache.has(tourId)) {\n      return this.toursCache.get(tourId);\n    }\n\n    try {\n      const tour = await fetchTour(tourId);\n      this.toursCache.set(tourId, tour);\n      return tour;\n    } catch (error) {\n      console.error(`[TourEngine] Failed to load tour ${tourId}:`, error);\n      return null;\n    }\n  }\n\n  /**\n   * Check if targeting rules match current context\n   * @param {Object} tour - Tour object\n   * @returns {boolean}\n   */\n  checkTargeting(tour) {\n    if (!tour.targeting || !tour.targeting.rules || tour.targeting.rules.length === 0) {\n      return true; // No targeting rules = show to everyone\n    }\n\n    const context = {\n      url: window.location.href,\n      pathname: window.location.pathname,\n      hostname: window.location.hostname,\n      search: window.location.search,\n      hash: window.location.hash,\n      referrer: document.referrer,\n      userId: this.sdk.userId,\n      visitorId: this.sdk.visitorId,\n      userTraits: this.sdk.userTraits,\n      device: this._getDeviceInfo(),\n      timestamp: Date.now(),\n    };\n\n    const { operator = 'AND', rules } = tour.targeting;\n\n    if (operator === 'AND') {\n      return rules.every((rule) => this._evaluateRule(rule, context));\n    } else if (operator === 'OR') {\n      return rules.some((rule) => this._evaluateRule(rule, context));\n    }\n\n    return true;\n  }\n\n  /**\n   * Determine if a tour should be shown\n   * @param {Object} tour - Tour object\n   * @param {Object} context - Current context\n   * @returns {boolean}\n   */\n  shouldShowTour(tour, context) {\n    // Check if tour is active\n    if (tour.status !== 'active') {\n      return false;\n    }\n\n    // Check date range\n    if (tour.startDate && new Date(tour.startDate) > new Date()) {\n      return false;\n    }\n    if (tour.endDate && new Date(tour.endDate) < new Date()) {\n      return false;\n    }\n\n    // Check frequency limits\n    const progress = this.getUserProgress(tour.id);\n    if (progress) {\n      // Already completed\n      if (progress.status === 'completed' && !tour.settings?.allowReplay) {\n        return false;\n      }\n\n      // Skipped and skip cooldown not passed\n      if (progress.status === 'skipped' && tour.settings?.skipCooldown) {\n        const cooldownEnd = new Date(progress.updatedAt).getTime() + tour.settings.skipCooldown;\n        if (Date.now() < cooldownEnd) {\n          return false;\n        }\n      }\n    }\n\n    // Check targeting rules\n    if (!this.checkTargeting(tour)) {\n      return false;\n    }\n\n    // Check page URL matching\n    if (tour.pageUrl) {\n      const currentUrl = window.location.pathname;\n      if (tour.pageUrlMatch === 'exact') {\n        if (currentUrl !== tour.pageUrl) return false;\n      } else if (tour.pageUrlMatch === 'contains') {\n        if (!currentUrl.includes(tour.pageUrl)) return false;\n      } else if (tour.pageUrlMatch === 'regex') {\n        try {\n          const regex = new RegExp(tour.pageUrl);\n          if (!regex.test(currentUrl)) return false;\n        } catch {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * Track an analytics event\n   * @param {string} eventType - Event type\n   * @param {Object} data - Event data\n   */\n  async trackEvent(eventType, data) {\n    try {\n      await apiTrackEvent({\n        eventType,\n        ...data,\n        visitorId: this.sdk.visitorId,\n        userId: this.sdk.userId,\n        timestamp: new Date().toISOString(),\n        url: window.location.href,\n        userAgent: navigator.userAgent,\n      });\n    } catch (error) {\n      console.error('[TourEngine] Failed to track event:', error);\n    }\n  }\n\n  /**\n   * Get user progress for a tour\n   * @param {string} tourId - Tour ID\n   * @returns {Object|null}\n   */\n  getUserProgress(tourId) {\n    return getProgress(tourId);\n  }\n\n  /**\n   * Save user progress\n   * @param {string} tourId - Tour ID\n   * @param {number} currentStep - Current step index\n   * @param {string} status - Status: 'in_progress', 'completed', 'skipped'\n   */\n  async saveProgress(tourId, currentStep, status) {\n    const data = {\n      tourId,\n      currentStep,\n      status,\n      visitorId: this.sdk.visitorId,\n      userId: this.sdk.userId,\n      updatedAt: new Date().toISOString(),\n    };\n\n    // Save locally\n    setProgress(tourId, data);\n\n    // Sync with server\n    try {\n      await syncProgress(data);\n    } catch (error) {\n      console.error('[TourEngine] Failed to sync progress:', error);\n    }\n  }\n\n  /**\n   * Clear cache\n   */\n  clearCache() {\n    this.toursCache.clear();\n    this.activeToursCache = null;\n    this.lastFetch = 0;\n  }\n\n  // Private methods\n\n  _evaluateRule(rule, context) {\n    const { type, field, operator, value } = rule;\n\n    let fieldValue;\n\n    switch (type) {\n      case 'url':\n        fieldValue = this._getUrlField(field, context);\n        break;\n      case 'user':\n        fieldValue = this._getUserField(field, context);\n        break;\n      case 'device':\n        fieldValue = context.device[field];\n        break;\n      case 'custom':\n        fieldValue = context.userTraits[field];\n        break;\n      default:\n        return true;\n    }\n\n    return this._compareValues(fieldValue, operator, value);\n  }\n\n  _getUrlField(field, context) {\n    switch (field) {\n      case 'pathname':\n        return context.pathname;\n      case 'hostname':\n        return context.hostname;\n      case 'search':\n        return context.search;\n      case 'hash':\n        return context.hash;\n      case 'full':\n        return context.url;\n      case 'referrer':\n        return context.referrer;\n      default:\n        return context.url;\n    }\n  }\n\n  _getUserField(field, context) {\n    switch (field) {\n      case 'id':\n        return context.userId;\n      case 'visitorId':\n        return context.visitorId;\n      default:\n        return context.userTraits[field];\n    }\n  }\n\n  _compareValues(fieldValue, operator, targetValue) {\n    if (fieldValue === undefined || fieldValue === null) {\n      return operator === 'not_exists' || operator === 'is_empty';\n    }\n\n    const strValue = String(fieldValue).toLowerCase();\n    const strTarget = String(targetValue).toLowerCase();\n\n    switch (operator) {\n      case 'equals':\n        return strValue === strTarget;\n      case 'not_equals':\n        return strValue !== strTarget;\n      case 'contains':\n        return strValue.includes(strTarget);\n      case 'not_contains':\n        return !strValue.includes(strTarget);\n      case 'starts_with':\n        return strValue.startsWith(strTarget);\n      case 'ends_with':\n        return strValue.endsWith(strTarget);\n      case 'matches_regex':\n        try {\n          return new RegExp(targetValue, 'i').test(fieldValue);\n        } catch {\n          return false;\n        }\n      case 'greater_than':\n        return Number(fieldValue) > Number(targetValue);\n      case 'less_than':\n        return Number(fieldValue) < Number(targetValue);\n      case 'exists':\n        return fieldValue !== undefined && fieldValue !== null;\n      case 'not_exists':\n        return fieldValue === undefined || fieldValue === null;\n      case 'is_empty':\n        return strValue === '';\n      case 'is_not_empty':\n        return strValue !== '';\n      case 'in_list':\n        const list = Array.isArray(targetValue) ? targetValue : targetValue.split(',');\n        return list.map((v) => v.trim().toLowerCase()).includes(strValue);\n      case 'not_in_list':\n        const notList = Array.isArray(targetValue) ? targetValue : targetValue.split(',');\n        return !notList.map((v) => v.trim().toLowerCase()).includes(strValue);\n      default:\n        return true;\n    }\n  }\n\n  _getDeviceInfo() {\n    const ua = navigator.userAgent;\n\n    return {\n      type: this._getDeviceType(ua),\n      browser: this._getBrowser(ua),\n      os: this._getOS(ua),\n      screenWidth: window.screen.width,\n      screenHeight: window.screen.height,\n      language: navigator.language,\n    };\n  }\n\n  _getDeviceType(ua) {\n    if (/tablet|ipad|playbook|silk/i.test(ua)) {\n      return 'tablet';\n    }\n    if (/mobile|iphone|ipod|android|blackberry|opera mini|iemobile/i.test(ua)) {\n      return 'mobile';\n    }\n    return 'desktop';\n  }\n\n  _getBrowser(ua) {\n    if (/edge/i.test(ua)) return 'edge';\n    if (/chrome/i.test(ua)) return 'chrome';\n    if (/firefox/i.test(ua)) return 'firefox';\n    if (/safari/i.test(ua)) return 'safari';\n    if (/msie|trident/i.test(ua)) return 'ie';\n    return 'unknown';\n  }\n\n  _getOS(ua) {\n    if (/windows/i.test(ua)) return 'windows';\n    if (/macintosh|mac os x/i.test(ua)) return 'macos';\n    if (/linux/i.test(ua)) return 'linux';\n    if (/android/i.test(ua)) return 'android';\n    if (/ios|iphone|ipad|ipod/i.test(ua)) return 'ios';\n    return 'unknown';\n  }\n}\n","/**\n * Positioning Utilities\n * Handles tooltip/modal positioning and viewport adjustments\n */\n\nconst ARROW_SIZE = 8;\nconst SPACING = 12;\n\n/**\n * Calculate position for tooltip relative to target element\n * @param {DOMRect} targetRect - Target element bounding rect\n * @param {DOMRect} tooltipRect - Tooltip element bounding rect\n * @param {string} preferredPosition - Preferred position (top, bottom, left, right, auto)\n * @returns {Object} - { top, left, actualPosition }\n */\nexport function calculatePosition(targetRect, tooltipRect, preferredPosition = 'bottom') {\n  const positions = {\n    top: {\n      top: targetRect.top - tooltipRect.height - SPACING,\n      left: targetRect.left + targetRect.width / 2 - tooltipRect.width / 2,\n    },\n    bottom: {\n      top: targetRect.bottom + SPACING,\n      left: targetRect.left + targetRect.width / 2 - tooltipRect.width / 2,\n    },\n    left: {\n      top: targetRect.top + targetRect.height / 2 - tooltipRect.height / 2,\n      left: targetRect.left - tooltipRect.width - SPACING,\n    },\n    right: {\n      top: targetRect.top + targetRect.height / 2 - tooltipRect.height / 2,\n      left: targetRect.right + SPACING,\n    },\n  };\n\n  // Auto position - find best fit\n  if (preferredPosition === 'auto') {\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n\n    // Check which positions fit in viewport\n    const fits = {\n      top: positions.top.top >= 0,\n      bottom: positions.bottom.top + tooltipRect.height <= viewportHeight,\n      left: positions.left.left >= 0,\n      right: positions.right.left + tooltipRect.width <= viewportWidth,\n    };\n\n    // Priority: bottom > top > right > left\n    if (fits.bottom) preferredPosition = 'bottom';\n    else if (fits.top) preferredPosition = 'top';\n    else if (fits.right) preferredPosition = 'right';\n    else if (fits.left) preferredPosition = 'left';\n    else preferredPosition = 'bottom'; // Default fallback\n  }\n\n  const position = positions[preferredPosition] || positions.bottom;\n\n  return {\n    top: position.top,\n    left: position.left,\n    actualPosition: preferredPosition,\n  };\n}\n\n/**\n * Adjust position to fit within viewport\n * @param {Object} position - { top, left }\n * @param {Object} dimensions - { width, height }\n * @returns {Object} - Adjusted { top, left }\n */\nexport function adjustForViewport(position, dimensions) {\n  const viewportWidth = window.innerWidth;\n  const viewportHeight = window.innerHeight;\n  const padding = 10; // Minimum distance from viewport edge\n\n  let { top, left } = position;\n  const { width, height } = dimensions;\n\n  // Horizontal adjustment\n  if (left < padding) {\n    left = padding;\n  } else if (left + width > viewportWidth - padding) {\n    left = viewportWidth - width - padding;\n  }\n\n  // Vertical adjustment\n  if (top < padding) {\n    top = padding;\n  } else if (top + height > viewportHeight - padding) {\n    top = viewportHeight - height - padding;\n  }\n\n  return { top, left };\n}\n\n/**\n * Get arrow position class based on tooltip position\n * @param {string} position - Tooltip position (top, bottom, left, right)\n * @returns {string} - Arrow position class\n */\nexport function getArrowPosition(position) {\n  // Arrow points opposite to tooltip position\n  const arrowPositions = {\n    top: 'bottom',\n    bottom: 'top',\n    left: 'right',\n    right: 'left',\n  };\n\n  return arrowPositions[position] || 'top';\n}\n\n/**\n * Calculate arrow offset for centered alignment\n * @param {DOMRect} targetRect - Target element rect\n * @param {DOMRect} tooltipRect - Tooltip element rect\n * @param {string} position - Tooltip position\n * @returns {Object} - { offset, direction }\n */\nexport function calculateArrowOffset(targetRect, tooltipRect, position) {\n  const tooltipCenter =\n    position === 'top' || position === 'bottom'\n      ? tooltipRect.left + tooltipRect.width / 2\n      : tooltipRect.top + tooltipRect.height / 2;\n\n  const targetCenter =\n    position === 'top' || position === 'bottom'\n      ? targetRect.left + targetRect.width / 2\n      : targetRect.top + targetRect.height / 2;\n\n  return {\n    offset: targetCenter - tooltipCenter,\n    direction: position === 'top' || position === 'bottom' ? 'horizontal' : 'vertical',\n  };\n}\n\n/**\n * Get optimal position based on available space\n * @param {DOMRect} targetRect - Target element rect\n * @param {Object} tooltipSize - { width, height }\n * @returns {string} - Best position\n */\nexport function getOptimalPosition(targetRect, tooltipSize) {\n  const viewportWidth = window.innerWidth;\n  const viewportHeight = window.innerHeight;\n\n  const spaceAbove = targetRect.top;\n  const spaceBelow = viewportHeight - targetRect.bottom;\n  const spaceLeft = targetRect.left;\n  const spaceRight = viewportWidth - targetRect.right;\n\n  const spaces = {\n    top: { space: spaceAbove, fits: spaceAbove >= tooltipSize.height + SPACING },\n    bottom: { space: spaceBelow, fits: spaceBelow >= tooltipSize.height + SPACING },\n    left: { space: spaceLeft, fits: spaceLeft >= tooltipSize.width + SPACING },\n    right: { space: spaceRight, fits: spaceRight >= tooltipSize.width + SPACING },\n  };\n\n  // Find positions that fit\n  const fittingPositions = Object.entries(spaces)\n    .filter(([, data]) => data.fits)\n    .sort(([, a], [, b]) => b.space - a.space);\n\n  if (fittingPositions.length > 0) {\n    return fittingPositions[0][0];\n  }\n\n  // If nothing fits perfectly, return position with most space\n  const allPositions = Object.entries(spaces).sort(([, a], [, b]) => b.space - a.space);\n\n  return allPositions[0][0];\n}\n\n/**\n * Calculate position for modal dialog\n * @param {Object} modalSize - { width, height }\n * @param {string} alignment - 'center', 'top', 'bottom'\n * @returns {Object} - { top, left }\n */\nexport function calculateModalPosition(modalSize, alignment = 'center') {\n  const viewportWidth = window.innerWidth;\n  const viewportHeight = window.innerHeight;\n\n  const left = (viewportWidth - modalSize.width) / 2;\n\n  let top;\n  switch (alignment) {\n    case 'top':\n      top = 60;\n      break;\n    case 'bottom':\n      top = viewportHeight - modalSize.height - 60;\n      break;\n    case 'center':\n    default:\n      top = (viewportHeight - modalSize.height) / 2;\n      break;\n  }\n\n  return { top, left };\n}\n\n/**\n * Calculate position for slideout panel\n * @param {number} width - Panel width\n * @param {string} side - 'left' or 'right'\n * @returns {Object} - CSS properties\n */\nexport function calculateSlideoutPosition(width, side = 'right') {\n  return {\n    top: 0,\n    bottom: 0,\n    [side]: 0,\n    width: `${width}px`,\n    [side === 'right' ? 'left' : 'right']: 'auto',\n  };\n}\n\n/**\n * Check if position would cause overflow\n * @param {Object} position - { top, left }\n * @param {Object} dimensions - { width, height }\n * @returns {Object} - { overflowTop, overflowRight, overflowBottom, overflowLeft }\n */\nexport function checkOverflow(position, dimensions) {\n  const viewportWidth = window.innerWidth;\n  const viewportHeight = window.innerHeight;\n\n  return {\n    overflowTop: position.top < 0,\n    overflowRight: position.left + dimensions.width > viewportWidth,\n    overflowBottom: position.top + dimensions.height > viewportHeight,\n    overflowLeft: position.left < 0,\n  };\n}\n\n/**\n * Get centered position in viewport\n * @param {Object} dimensions - { width, height }\n * @returns {Object} - { top, left }\n */\nexport function getCenteredPosition(dimensions) {\n  const viewportWidth = window.innerWidth;\n  const viewportHeight = window.innerHeight;\n\n  return {\n    top: (viewportHeight - dimensions.height) / 2,\n    left: (viewportWidth - dimensions.width) / 2,\n  };\n}\n","/**\n * Tooltip Component\n * Displays a tooltip attached to a target element\n */\n\nimport { calculatePosition, adjustForViewport, getArrowPosition } from '../utils/positioning';\n\nexport class Tooltip {\n  constructor(options) {\n    this.options = {\n      title: '',\n      content: '',\n      position: 'bottom', // top, bottom, left, right, auto\n      targetElement: null,\n      media: null, // { type: 'image'|'video', src: '...', alt: '...' }\n      buttons: null, // Custom buttons\n      stepIndex: 0,\n      totalSteps: 1,\n      showBackButton: false,\n      showSkipButton: true,\n      onNext: () => {},\n      onPrev: () => {},\n      onSkip: () => {},\n      onClose: () => {},\n      theme: 'light',\n      primaryColor: null,\n      ...options,\n    };\n\n    this.element = null;\n    this.arrowElement = null;\n    this._resizeHandler = null;\n    this._scrollHandler = null;\n  }\n\n  render(container) {\n    this._createTooltip();\n    container.appendChild(this.element);\n    this._positionTooltip();\n    this._setupListeners();\n    this._animateIn();\n  }\n\n  destroy() {\n    this._removeListeners();\n\n    if (this.element && this.element.parentNode) {\n      this.element.classList.add('bbt-tooltip--exit');\n      setTimeout(() => {\n        if (this.element && this.element.parentNode) {\n          this.element.parentNode.removeChild(this.element);\n        }\n      }, 200);\n    }\n\n    this.element = null;\n    this.arrowElement = null;\n  }\n\n  _createTooltip() {\n    const {\n      title,\n      content,\n      media,\n      buttons,\n      stepIndex,\n      totalSteps,\n      showBackButton,\n      showSkipButton,\n      theme,\n      primaryColor,\n    } = this.options;\n\n    this.element = document.createElement('div');\n    this.element.className = `bbt-tooltip bbt-tooltip--${theme}`;\n\n    if (primaryColor) {\n      this.element.style.setProperty('--bbt-primary-color', primaryColor);\n    }\n\n    // Arrow\n    this.arrowElement = document.createElement('div');\n    this.arrowElement.className = 'bbt-tooltip__arrow';\n    this.element.appendChild(this.arrowElement);\n\n    // Content wrapper\n    const wrapper = document.createElement('div');\n    wrapper.className = 'bbt-tooltip__wrapper';\n\n    // Close button\n    const closeBtn = document.createElement('button');\n    closeBtn.className = 'bbt-tooltip__close';\n    closeBtn.innerHTML = '&times;';\n    closeBtn.setAttribute('aria-label', 'Close');\n    closeBtn.onclick = (e) => {\n      e.preventDefault();\n      this.options.onClose();\n    };\n    wrapper.appendChild(closeBtn);\n\n    // Media\n    if (media) {\n      const mediaEl = this._createMedia(media);\n      wrapper.appendChild(mediaEl);\n    }\n\n    // Header with title\n    if (title) {\n      const header = document.createElement('div');\n      header.className = 'bbt-tooltip__header';\n\n      const titleEl = document.createElement('h4');\n      titleEl.className = 'bbt-tooltip__title';\n      titleEl.textContent = title;\n      header.appendChild(titleEl);\n\n      wrapper.appendChild(header);\n    }\n\n    // Content\n    if (content) {\n      const contentEl = document.createElement('div');\n      contentEl.className = 'bbt-tooltip__content';\n      contentEl.innerHTML = content;\n      wrapper.appendChild(contentEl);\n    }\n\n    // Footer with actions\n    const footer = document.createElement('div');\n    footer.className = 'bbt-tooltip__footer';\n\n    // Progress indicator\n    if (totalSteps > 1) {\n      const progress = document.createElement('span');\n      progress.className = 'bbt-tooltip__progress';\n      progress.textContent = `${stepIndex + 1} / ${totalSteps}`;\n      footer.appendChild(progress);\n    }\n\n    // Actions\n    const actions = document.createElement('div');\n    actions.className = 'bbt-tooltip__actions';\n\n    if (buttons) {\n      // Custom buttons\n      buttons.forEach((btn) => {\n        const button = document.createElement('button');\n        button.className = `bbt-btn bbt-btn--${btn.variant || 'secondary'}`;\n        button.textContent = btn.text;\n        button.onclick = (e) => {\n          e.preventDefault();\n          if (btn.action === 'next') this.options.onNext();\n          else if (btn.action === 'prev') this.options.onPrev();\n          else if (btn.action === 'skip') this.options.onSkip();\n          else if (btn.action === 'close') this.options.onClose();\n          else if (btn.onClick) btn.onClick();\n        };\n        actions.appendChild(button);\n      });\n    } else {\n      // Default buttons\n      if (showSkipButton && stepIndex < totalSteps - 1) {\n        const skipBtn = document.createElement('button');\n        skipBtn.className = 'bbt-btn bbt-btn--text';\n        skipBtn.textContent = 'Skip';\n        skipBtn.onclick = (e) => {\n          e.preventDefault();\n          this.options.onSkip();\n        };\n        actions.appendChild(skipBtn);\n      }\n\n      if (showBackButton) {\n        const backBtn = document.createElement('button');\n        backBtn.className = 'bbt-btn bbt-btn--secondary';\n        backBtn.textContent = 'Back';\n        backBtn.onclick = (e) => {\n          e.preventDefault();\n          this.options.onPrev();\n        };\n        actions.appendChild(backBtn);\n      }\n\n      const nextBtn = document.createElement('button');\n      nextBtn.className = 'bbt-btn bbt-btn--primary';\n      nextBtn.textContent = stepIndex >= totalSteps - 1 ? 'Done' : 'Next';\n      nextBtn.onclick = (e) => {\n        e.preventDefault();\n        this.options.onNext();\n      };\n      actions.appendChild(nextBtn);\n    }\n\n    footer.appendChild(actions);\n    wrapper.appendChild(footer);\n    this.element.appendChild(wrapper);\n  }\n\n  _createMedia(media) {\n    const container = document.createElement('div');\n    container.className = 'bbt-tooltip__media';\n\n    if (media.type === 'image') {\n      const img = document.createElement('img');\n      img.src = media.src;\n      img.alt = media.alt || '';\n      img.className = 'bbt-tooltip__image';\n      container.appendChild(img);\n    } else if (media.type === 'video') {\n      const video = document.createElement('video');\n      video.src = media.src;\n      video.controls = true;\n      video.autoplay = media.autoplay || false;\n      video.muted = media.muted || true;\n      video.loop = media.loop || false;\n      video.className = 'bbt-tooltip__video';\n      container.appendChild(video);\n    } else if (media.type === 'embed') {\n      const iframe = document.createElement('iframe');\n      iframe.src = media.src;\n      iframe.className = 'bbt-tooltip__embed';\n      iframe.allowFullscreen = true;\n      container.appendChild(iframe);\n    }\n\n    return container;\n  }\n\n  _positionTooltip() {\n    const { targetElement, position } = this.options;\n\n    if (!targetElement) {\n      // Center in viewport if no target\n      this.element.style.position = 'fixed';\n      this.element.style.top = '50%';\n      this.element.style.left = '50%';\n      this.element.style.transform = 'translate(-50%, -50%)';\n      this.arrowElement.style.display = 'none';\n      return;\n    }\n\n    const targetRect = targetElement.getBoundingClientRect();\n    const tooltipRect = this.element.getBoundingClientRect();\n\n    const { top, left, actualPosition } = calculatePosition(\n      targetRect,\n      tooltipRect,\n      position\n    );\n\n    const adjusted = adjustForViewport(\n      { top, left },\n      { width: tooltipRect.width, height: tooltipRect.height }\n    );\n\n    this.element.style.position = 'fixed';\n    this.element.style.top = `${adjusted.top}px`;\n    this.element.style.left = `${adjusted.left}px`;\n\n    // Position arrow\n    const arrowPosition = getArrowPosition(actualPosition);\n    this.arrowElement.className = `bbt-tooltip__arrow bbt-tooltip__arrow--${arrowPosition}`;\n  }\n\n  _setupListeners() {\n    // Reposition on resize and scroll\n    this._resizeHandler = () => this._positionTooltip();\n    this._scrollHandler = () => this._positionTooltip();\n\n    window.addEventListener('resize', this._resizeHandler);\n    window.addEventListener('scroll', this._scrollHandler, true);\n\n    // Keyboard navigation\n    this._keyHandler = (e) => {\n      if (e.key === 'Escape') {\n        this.options.onClose();\n      } else if (e.key === 'ArrowRight' || e.key === 'Enter') {\n        this.options.onNext();\n      } else if (e.key === 'ArrowLeft') {\n        this.options.onPrev();\n      }\n    };\n    document.addEventListener('keydown', this._keyHandler);\n  }\n\n  _removeListeners() {\n    if (this._resizeHandler) {\n      window.removeEventListener('resize', this._resizeHandler);\n    }\n    if (this._scrollHandler) {\n      window.removeEventListener('scroll', this._scrollHandler, true);\n    }\n    if (this._keyHandler) {\n      document.removeEventListener('keydown', this._keyHandler);\n    }\n  }\n\n  _animateIn() {\n    requestAnimationFrame(() => {\n      this.element.classList.add('bbt-tooltip--enter');\n    });\n  }\n}\n","/**\n * Modal Component\n * Displays a centered modal dialog\n */\n\nexport class Modal {\n  constructor(options) {\n    this.options = {\n      title: '',\n      content: '',\n      size: 'medium', // small, medium, large\n      media: null,\n      buttons: null,\n      stepIndex: 0,\n      totalSteps: 1,\n      showBackButton: false,\n      showSkipButton: true,\n      onNext: () => {},\n      onPrev: () => {},\n      onSkip: () => {},\n      onClose: () => {},\n      theme: 'light',\n      primaryColor: null,\n      closeOnBackdrop: true,\n      closeOnEscape: true,\n      ...options,\n    };\n\n    this.element = null;\n    this.backdropElement = null;\n    this._keyHandler = null;\n  }\n\n  render(container) {\n    this._createBackdrop();\n    this._createModal();\n\n    container.appendChild(this.backdropElement);\n    container.appendChild(this.element);\n\n    this._setupListeners();\n    this._animateIn();\n\n    // Focus trap\n    this.element.focus();\n  }\n\n  destroy() {\n    this._removeListeners();\n\n    if (this.element) {\n      this.element.classList.add('bbt-modal--exit');\n    }\n    if (this.backdropElement) {\n      this.backdropElement.classList.add('bbt-modal-backdrop--exit');\n    }\n\n    setTimeout(() => {\n      if (this.element && this.element.parentNode) {\n        this.element.parentNode.removeChild(this.element);\n      }\n      if (this.backdropElement && this.backdropElement.parentNode) {\n        this.backdropElement.parentNode.removeChild(this.backdropElement);\n      }\n    }, 200);\n\n    this.element = null;\n    this.backdropElement = null;\n  }\n\n  _createBackdrop() {\n    this.backdropElement = document.createElement('div');\n    this.backdropElement.className = `bbt-modal-backdrop bbt-modal-backdrop--${this.options.theme}`;\n\n    if (this.options.closeOnBackdrop) {\n      this.backdropElement.onclick = (e) => {\n        if (e.target === this.backdropElement) {\n          this.options.onClose();\n        }\n      };\n    }\n  }\n\n  _createModal() {\n    const {\n      title,\n      content,\n      size,\n      media,\n      buttons,\n      stepIndex,\n      totalSteps,\n      showBackButton,\n      showSkipButton,\n      theme,\n      primaryColor,\n    } = this.options;\n\n    this.element = document.createElement('div');\n    this.element.className = `bbt-modal bbt-modal--${size} bbt-modal--${theme}`;\n    this.element.setAttribute('role', 'dialog');\n    this.element.setAttribute('aria-modal', 'true');\n    this.element.setAttribute('tabindex', '-1');\n\n    if (primaryColor) {\n      this.element.style.setProperty('--bbt-primary-color', primaryColor);\n    }\n\n    // Close button\n    const closeBtn = document.createElement('button');\n    closeBtn.className = 'bbt-modal__close';\n    closeBtn.innerHTML = '&times;';\n    closeBtn.setAttribute('aria-label', 'Close');\n    closeBtn.onclick = (e) => {\n      e.preventDefault();\n      this.options.onClose();\n    };\n    this.element.appendChild(closeBtn);\n\n    // Media\n    if (media) {\n      const mediaEl = this._createMedia(media);\n      this.element.appendChild(mediaEl);\n    }\n\n    // Header\n    if (title) {\n      const header = document.createElement('div');\n      header.className = 'bbt-modal__header';\n\n      const titleEl = document.createElement('h3');\n      titleEl.className = 'bbt-modal__title';\n      titleEl.textContent = title;\n      header.appendChild(titleEl);\n\n      this.element.appendChild(header);\n    }\n\n    // Body\n    if (content) {\n      const body = document.createElement('div');\n      body.className = 'bbt-modal__body';\n      body.innerHTML = content;\n      this.element.appendChild(body);\n    }\n\n    // Footer\n    const footer = document.createElement('div');\n    footer.className = 'bbt-modal__footer';\n\n    // Progress\n    if (totalSteps > 1) {\n      const progress = document.createElement('div');\n      progress.className = 'bbt-modal__progress';\n\n      for (let i = 0; i < totalSteps; i++) {\n        const dot = document.createElement('span');\n        dot.className = `bbt-modal__progress-dot ${i === stepIndex ? 'bbt-modal__progress-dot--active' : ''} ${i < stepIndex ? 'bbt-modal__progress-dot--completed' : ''}`;\n        progress.appendChild(dot);\n      }\n\n      footer.appendChild(progress);\n    }\n\n    // Actions\n    const actions = document.createElement('div');\n    actions.className = 'bbt-modal__actions';\n\n    if (buttons) {\n      buttons.forEach((btn) => {\n        const button = document.createElement('button');\n        button.className = `bbt-btn bbt-btn--${btn.variant || 'secondary'}`;\n        button.textContent = btn.text;\n        button.onclick = (e) => {\n          e.preventDefault();\n          if (btn.action === 'next') this.options.onNext();\n          else if (btn.action === 'prev') this.options.onPrev();\n          else if (btn.action === 'skip') this.options.onSkip();\n          else if (btn.action === 'close') this.options.onClose();\n          else if (btn.onClick) btn.onClick();\n        };\n        actions.appendChild(button);\n      });\n    } else {\n      if (showSkipButton && stepIndex < totalSteps - 1) {\n        const skipBtn = document.createElement('button');\n        skipBtn.className = 'bbt-btn bbt-btn--text';\n        skipBtn.textContent = 'Skip tour';\n        skipBtn.onclick = (e) => {\n          e.preventDefault();\n          this.options.onSkip();\n        };\n        actions.appendChild(skipBtn);\n      }\n\n      if (showBackButton) {\n        const backBtn = document.createElement('button');\n        backBtn.className = 'bbt-btn bbt-btn--secondary';\n        backBtn.textContent = 'Back';\n        backBtn.onclick = (e) => {\n          e.preventDefault();\n          this.options.onPrev();\n        };\n        actions.appendChild(backBtn);\n      }\n\n      const nextBtn = document.createElement('button');\n      nextBtn.className = 'bbt-btn bbt-btn--primary';\n      nextBtn.textContent = stepIndex >= totalSteps - 1 ? 'Get Started' : 'Next';\n      nextBtn.onclick = (e) => {\n        e.preventDefault();\n        this.options.onNext();\n      };\n      actions.appendChild(nextBtn);\n    }\n\n    footer.appendChild(actions);\n    this.element.appendChild(footer);\n  }\n\n  _createMedia(media) {\n    const container = document.createElement('div');\n    container.className = 'bbt-modal__media';\n\n    if (media.type === 'image') {\n      const img = document.createElement('img');\n      img.src = media.src;\n      img.alt = media.alt || '';\n      img.className = 'bbt-modal__image';\n      container.appendChild(img);\n    } else if (media.type === 'video') {\n      const video = document.createElement('video');\n      video.src = media.src;\n      video.controls = true;\n      video.autoplay = media.autoplay || false;\n      video.muted = media.muted !== false;\n      video.loop = media.loop || false;\n      video.className = 'bbt-modal__video';\n      container.appendChild(video);\n    } else if (media.type === 'embed') {\n      const iframe = document.createElement('iframe');\n      iframe.src = media.src;\n      iframe.className = 'bbt-modal__embed';\n      iframe.allowFullscreen = true;\n      container.appendChild(iframe);\n    } else if (media.type === 'lottie') {\n      const lottieContainer = document.createElement('div');\n      lottieContainer.className = 'bbt-modal__lottie';\n      lottieContainer.setAttribute('data-lottie-src', media.src);\n      container.appendChild(lottieContainer);\n    }\n\n    return container;\n  }\n\n  _setupListeners() {\n    if (this.options.closeOnEscape) {\n      this._keyHandler = (e) => {\n        if (e.key === 'Escape') {\n          this.options.onClose();\n        } else if (e.key === 'ArrowRight' || e.key === 'Enter') {\n          this.options.onNext();\n        } else if (e.key === 'ArrowLeft') {\n          this.options.onPrev();\n        }\n      };\n      document.addEventListener('keydown', this._keyHandler);\n    }\n  }\n\n  _removeListeners() {\n    if (this._keyHandler) {\n      document.removeEventListener('keydown', this._keyHandler);\n    }\n  }\n\n  _animateIn() {\n    requestAnimationFrame(() => {\n      this.backdropElement.classList.add('bbt-modal-backdrop--enter');\n      this.element.classList.add('bbt-modal--enter');\n    });\n  }\n}\n","/**\n * Hotspot Component\n * Displays a pulsing dot that reveals a tooltip on click/hover\n */\n\nimport { calculatePosition, adjustForViewport, getArrowPosition } from '../utils/positioning';\n\nexport class Hotspot {\n  constructor(options) {\n    this.options = {\n      targetElement: null,\n      title: '',\n      content: '',\n      position: 'right', // top, bottom, left, right\n      color: null, // Custom color\n      pulse: true,\n      triggerOn: 'click', // click, hover\n      stepIndex: 0,\n      totalSteps: 1,\n      showBackButton: false,\n      showSkipButton: true,\n      onNext: () => {},\n      onPrev: () => {},\n      onSkip: () => {},\n      onClose: () => {},\n      theme: 'light',\n      primaryColor: null,\n      ...options,\n    };\n\n    this.hotspotElement = null;\n    this.tooltipElement = null;\n    this.isTooltipVisible = false;\n    this._resizeHandler = null;\n    this._scrollHandler = null;\n  }\n\n  render(container) {\n    this._createHotspot();\n    this._createTooltip();\n\n    container.appendChild(this.hotspotElement);\n    container.appendChild(this.tooltipElement);\n\n    this._positionHotspot();\n    this._setupListeners();\n    this._animateIn();\n  }\n\n  destroy() {\n    this._removeListeners();\n\n    if (this.hotspotElement) {\n      this.hotspotElement.classList.add('bbt-hotspot--exit');\n    }\n    if (this.tooltipElement) {\n      this.tooltipElement.classList.add('bbt-hotspot-tooltip--exit');\n    }\n\n    setTimeout(() => {\n      if (this.hotspotElement && this.hotspotElement.parentNode) {\n        this.hotspotElement.parentNode.removeChild(this.hotspotElement);\n      }\n      if (this.tooltipElement && this.tooltipElement.parentNode) {\n        this.tooltipElement.parentNode.removeChild(this.tooltipElement);\n      }\n    }, 200);\n\n    this.hotspotElement = null;\n    this.tooltipElement = null;\n  }\n\n  _createHotspot() {\n    const { color, pulse, theme, primaryColor } = this.options;\n\n    this.hotspotElement = document.createElement('div');\n    this.hotspotElement.className = `bbt-hotspot bbt-hotspot--${theme}`;\n\n    if (pulse) {\n      this.hotspotElement.classList.add('bbt-hotspot--pulse');\n    }\n\n    // Inner dot\n    const dot = document.createElement('div');\n    dot.className = 'bbt-hotspot__dot';\n\n    if (color || primaryColor) {\n      dot.style.backgroundColor = color || primaryColor;\n    }\n\n    // Pulse ring\n    const ring = document.createElement('div');\n    ring.className = 'bbt-hotspot__ring';\n\n    if (color || primaryColor) {\n      ring.style.borderColor = color || primaryColor;\n    }\n\n    this.hotspotElement.appendChild(dot);\n    this.hotspotElement.appendChild(ring);\n  }\n\n  _createTooltip() {\n    const {\n      title,\n      content,\n      stepIndex,\n      totalSteps,\n      showBackButton,\n      showSkipButton,\n      theme,\n      primaryColor,\n    } = this.options;\n\n    this.tooltipElement = document.createElement('div');\n    this.tooltipElement.className = `bbt-hotspot-tooltip bbt-hotspot-tooltip--${theme}`;\n    this.tooltipElement.style.display = 'none';\n\n    if (primaryColor) {\n      this.tooltipElement.style.setProperty('--bbt-primary-color', primaryColor);\n    }\n\n    // Arrow\n    const arrow = document.createElement('div');\n    arrow.className = 'bbt-hotspot-tooltip__arrow';\n    this.tooltipElement.appendChild(arrow);\n\n    // Close button\n    const closeBtn = document.createElement('button');\n    closeBtn.className = 'bbt-hotspot-tooltip__close';\n    closeBtn.innerHTML = '&times;';\n    closeBtn.onclick = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.options.onClose();\n    };\n    this.tooltipElement.appendChild(closeBtn);\n\n    // Content wrapper\n    const wrapper = document.createElement('div');\n    wrapper.className = 'bbt-hotspot-tooltip__wrapper';\n\n    if (title) {\n      const titleEl = document.createElement('h4');\n      titleEl.className = 'bbt-hotspot-tooltip__title';\n      titleEl.textContent = title;\n      wrapper.appendChild(titleEl);\n    }\n\n    if (content) {\n      const contentEl = document.createElement('div');\n      contentEl.className = 'bbt-hotspot-tooltip__content';\n      contentEl.innerHTML = content;\n      wrapper.appendChild(contentEl);\n    }\n\n    // Footer\n    const footer = document.createElement('div');\n    footer.className = 'bbt-hotspot-tooltip__footer';\n\n    if (totalSteps > 1) {\n      const progress = document.createElement('span');\n      progress.className = 'bbt-hotspot-tooltip__progress';\n      progress.textContent = `${stepIndex + 1} / ${totalSteps}`;\n      footer.appendChild(progress);\n    }\n\n    const actions = document.createElement('div');\n    actions.className = 'bbt-hotspot-tooltip__actions';\n\n    if (showSkipButton && stepIndex < totalSteps - 1) {\n      const skipBtn = document.createElement('button');\n      skipBtn.className = 'bbt-btn bbt-btn--text bbt-btn--sm';\n      skipBtn.textContent = 'Skip';\n      skipBtn.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.options.onSkip();\n      };\n      actions.appendChild(skipBtn);\n    }\n\n    if (showBackButton) {\n      const backBtn = document.createElement('button');\n      backBtn.className = 'bbt-btn bbt-btn--secondary bbt-btn--sm';\n      backBtn.textContent = 'Back';\n      backBtn.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.options.onPrev();\n      };\n      actions.appendChild(backBtn);\n    }\n\n    const nextBtn = document.createElement('button');\n    nextBtn.className = 'bbt-btn bbt-btn--primary bbt-btn--sm';\n    nextBtn.textContent = stepIndex >= totalSteps - 1 ? 'Done' : 'Next';\n    nextBtn.onclick = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      this.options.onNext();\n    };\n    actions.appendChild(nextBtn);\n\n    footer.appendChild(actions);\n    wrapper.appendChild(footer);\n    this.tooltipElement.appendChild(wrapper);\n  }\n\n  _positionHotspot() {\n    const { targetElement, position } = this.options;\n\n    if (!targetElement) return;\n\n    const targetRect = targetElement.getBoundingClientRect();\n\n    // Position hotspot relative to target element\n    let top, left;\n\n    switch (position) {\n      case 'top':\n        top = targetRect.top - 12;\n        left = targetRect.left + targetRect.width / 2;\n        break;\n      case 'bottom':\n        top = targetRect.bottom + 12;\n        left = targetRect.left + targetRect.width / 2;\n        break;\n      case 'left':\n        top = targetRect.top + targetRect.height / 2;\n        left = targetRect.left - 12;\n        break;\n      case 'right':\n      default:\n        top = targetRect.top + targetRect.height / 2;\n        left = targetRect.right + 12;\n        break;\n    }\n\n    this.hotspotElement.style.position = 'fixed';\n    this.hotspotElement.style.top = `${top}px`;\n    this.hotspotElement.style.left = `${left}px`;\n  }\n\n  _positionTooltip() {\n    if (!this.isTooltipVisible) return;\n\n    const hotspotRect = this.hotspotElement.getBoundingClientRect();\n    const tooltipRect = this.tooltipElement.getBoundingClientRect();\n\n    // Position tooltip relative to hotspot\n    const { top, left, actualPosition } = calculatePosition(\n      hotspotRect,\n      tooltipRect,\n      this.options.position === 'right' ? 'right' : 'bottom'\n    );\n\n    const adjusted = adjustForViewport(\n      { top, left },\n      { width: tooltipRect.width, height: tooltipRect.height }\n    );\n\n    this.tooltipElement.style.position = 'fixed';\n    this.tooltipElement.style.top = `${adjusted.top}px`;\n    this.tooltipElement.style.left = `${adjusted.left}px`;\n\n    // Update arrow position\n    const arrow = this.tooltipElement.querySelector('.bbt-hotspot-tooltip__arrow');\n    if (arrow) {\n      arrow.className = `bbt-hotspot-tooltip__arrow bbt-hotspot-tooltip__arrow--${getArrowPosition(actualPosition)}`;\n    }\n  }\n\n  _showTooltip() {\n    if (this.isTooltipVisible) return;\n\n    this.isTooltipVisible = true;\n    this.tooltipElement.style.display = 'block';\n\n    requestAnimationFrame(() => {\n      this._positionTooltip();\n      this.tooltipElement.classList.add('bbt-hotspot-tooltip--enter');\n    });\n  }\n\n  _hideTooltip() {\n    if (!this.isTooltipVisible) return;\n\n    this.isTooltipVisible = false;\n    this.tooltipElement.classList.remove('bbt-hotspot-tooltip--enter');\n    this.tooltipElement.classList.add('bbt-hotspot-tooltip--exit');\n\n    setTimeout(() => {\n      this.tooltipElement.style.display = 'none';\n      this.tooltipElement.classList.remove('bbt-hotspot-tooltip--exit');\n    }, 200);\n  }\n\n  _toggleTooltip() {\n    if (this.isTooltipVisible) {\n      this._hideTooltip();\n    } else {\n      this._showTooltip();\n    }\n  }\n\n  _setupListeners() {\n    const { triggerOn } = this.options;\n\n    // Hotspot click/hover\n    if (triggerOn === 'click') {\n      this.hotspotElement.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this._toggleTooltip();\n      };\n    } else if (triggerOn === 'hover') {\n      this.hotspotElement.onmouseenter = () => this._showTooltip();\n      this.hotspotElement.onmouseleave = () => {\n        // Delay to allow moving to tooltip\n        setTimeout(() => {\n          if (!this.tooltipElement.matches(':hover')) {\n            this._hideTooltip();\n          }\n        }, 100);\n      };\n      this.tooltipElement.onmouseleave = () => this._hideTooltip();\n    }\n\n    // Reposition on resize/scroll\n    this._resizeHandler = () => {\n      this._positionHotspot();\n      this._positionTooltip();\n    };\n    this._scrollHandler = () => {\n      this._positionHotspot();\n      this._positionTooltip();\n    };\n\n    window.addEventListener('resize', this._resizeHandler);\n    window.addEventListener('scroll', this._scrollHandler, true);\n\n    // Click outside to close\n    this._clickOutsideHandler = (e) => {\n      if (\n        this.isTooltipVisible &&\n        !this.tooltipElement.contains(e.target) &&\n        !this.hotspotElement.contains(e.target)\n      ) {\n        this._hideTooltip();\n      }\n    };\n    document.addEventListener('click', this._clickOutsideHandler);\n\n    // Keyboard\n    this._keyHandler = (e) => {\n      if (e.key === 'Escape') {\n        if (this.isTooltipVisible) {\n          this._hideTooltip();\n        } else {\n          this.options.onClose();\n        }\n      }\n    };\n    document.addEventListener('keydown', this._keyHandler);\n\n    // Auto-show tooltip after animation\n    setTimeout(() => {\n      this._showTooltip();\n    }, 500);\n  }\n\n  _removeListeners() {\n    if (this._resizeHandler) {\n      window.removeEventListener('resize', this._resizeHandler);\n    }\n    if (this._scrollHandler) {\n      window.removeEventListener('scroll', this._scrollHandler, true);\n    }\n    if (this._clickOutsideHandler) {\n      document.removeEventListener('click', this._clickOutsideHandler);\n    }\n    if (this._keyHandler) {\n      document.removeEventListener('keydown', this._keyHandler);\n    }\n  }\n\n  _animateIn() {\n    requestAnimationFrame(() => {\n      this.hotspotElement.classList.add('bbt-hotspot--enter');\n    });\n  }\n}\n","/**\n * Slideout Component\n * Displays a side panel that slides in from left or right\n */\n\nexport class Slideout {\n  constructor(options) {\n    this.options = {\n      title: '',\n      content: '',\n      position: 'right', // left, right\n      width: 400, // Width in pixels\n      media: null,\n      buttons: null,\n      stepIndex: 0,\n      totalSteps: 1,\n      showBackButton: false,\n      showSkipButton: true,\n      onNext: () => {},\n      onPrev: () => {},\n      onSkip: () => {},\n      onClose: () => {},\n      theme: 'light',\n      primaryColor: null,\n      showOverlay: true,\n      closeOnOverlay: true,\n      ...options,\n    };\n\n    this.element = null;\n    this.overlayElement = null;\n    this._keyHandler = null;\n  }\n\n  render(container) {\n    if (this.options.showOverlay) {\n      this._createOverlay();\n      container.appendChild(this.overlayElement);\n    }\n\n    this._createSlideout();\n    container.appendChild(this.element);\n\n    this._setupListeners();\n    this._animateIn();\n  }\n\n  destroy() {\n    this._removeListeners();\n\n    if (this.element) {\n      this.element.classList.remove('bbt-slideout--enter');\n      this.element.classList.add('bbt-slideout--exit');\n    }\n    if (this.overlayElement) {\n      this.overlayElement.classList.remove('bbt-slideout-overlay--enter');\n      this.overlayElement.classList.add('bbt-slideout-overlay--exit');\n    }\n\n    setTimeout(() => {\n      if (this.element && this.element.parentNode) {\n        this.element.parentNode.removeChild(this.element);\n      }\n      if (this.overlayElement && this.overlayElement.parentNode) {\n        this.overlayElement.parentNode.removeChild(this.overlayElement);\n      }\n    }, 300);\n\n    this.element = null;\n    this.overlayElement = null;\n  }\n\n  _createOverlay() {\n    this.overlayElement = document.createElement('div');\n    this.overlayElement.className = `bbt-slideout-overlay bbt-slideout-overlay--${this.options.theme}`;\n\n    if (this.options.closeOnOverlay) {\n      this.overlayElement.onclick = () => this.options.onClose();\n    }\n  }\n\n  _createSlideout() {\n    const {\n      title,\n      content,\n      position,\n      width,\n      media,\n      buttons,\n      stepIndex,\n      totalSteps,\n      showBackButton,\n      showSkipButton,\n      theme,\n      primaryColor,\n    } = this.options;\n\n    this.element = document.createElement('div');\n    this.element.className = `bbt-slideout bbt-slideout--${position} bbt-slideout--${theme}`;\n    this.element.style.width = `${width}px`;\n\n    if (primaryColor) {\n      this.element.style.setProperty('--bbt-primary-color', primaryColor);\n    }\n\n    // Header\n    const header = document.createElement('div');\n    header.className = 'bbt-slideout__header';\n\n    if (title) {\n      const titleEl = document.createElement('h3');\n      titleEl.className = 'bbt-slideout__title';\n      titleEl.textContent = title;\n      header.appendChild(titleEl);\n    }\n\n    const closeBtn = document.createElement('button');\n    closeBtn.className = 'bbt-slideout__close';\n    closeBtn.innerHTML = '&times;';\n    closeBtn.setAttribute('aria-label', 'Close');\n    closeBtn.onclick = (e) => {\n      e.preventDefault();\n      this.options.onClose();\n    };\n    header.appendChild(closeBtn);\n\n    this.element.appendChild(header);\n\n    // Body\n    const body = document.createElement('div');\n    body.className = 'bbt-slideout__body';\n\n    // Media\n    if (media) {\n      const mediaEl = this._createMedia(media);\n      body.appendChild(mediaEl);\n    }\n\n    // Content\n    if (content) {\n      const contentEl = document.createElement('div');\n      contentEl.className = 'bbt-slideout__content';\n      contentEl.innerHTML = content;\n      body.appendChild(contentEl);\n    }\n\n    this.element.appendChild(body);\n\n    // Footer\n    const footer = document.createElement('div');\n    footer.className = 'bbt-slideout__footer';\n\n    // Progress\n    if (totalSteps > 1) {\n      const progress = document.createElement('div');\n      progress.className = 'bbt-slideout__progress';\n\n      const progressBar = document.createElement('div');\n      progressBar.className = 'bbt-slideout__progress-bar';\n\n      const progressFill = document.createElement('div');\n      progressFill.className = 'bbt-slideout__progress-fill';\n      progressFill.style.width = `${((stepIndex + 1) / totalSteps) * 100}%`;\n\n      progressBar.appendChild(progressFill);\n      progress.appendChild(progressBar);\n\n      const progressText = document.createElement('span');\n      progressText.className = 'bbt-slideout__progress-text';\n      progressText.textContent = `Step ${stepIndex + 1} of ${totalSteps}`;\n      progress.appendChild(progressText);\n\n      footer.appendChild(progress);\n    }\n\n    // Actions\n    const actions = document.createElement('div');\n    actions.className = 'bbt-slideout__actions';\n\n    if (buttons) {\n      buttons.forEach((btn) => {\n        const button = document.createElement('button');\n        button.className = `bbt-btn bbt-btn--${btn.variant || 'secondary'}`;\n        button.textContent = btn.text;\n        button.onclick = (e) => {\n          e.preventDefault();\n          if (btn.action === 'next') this.options.onNext();\n          else if (btn.action === 'prev') this.options.onPrev();\n          else if (btn.action === 'skip') this.options.onSkip();\n          else if (btn.action === 'close') this.options.onClose();\n          else if (btn.onClick) btn.onClick();\n        };\n        actions.appendChild(button);\n      });\n    } else {\n      if (showSkipButton && stepIndex < totalSteps - 1) {\n        const skipBtn = document.createElement('button');\n        skipBtn.className = 'bbt-btn bbt-btn--text';\n        skipBtn.textContent = 'Skip tour';\n        skipBtn.onclick = (e) => {\n          e.preventDefault();\n          this.options.onSkip();\n        };\n        actions.appendChild(skipBtn);\n      }\n\n      const buttonGroup = document.createElement('div');\n      buttonGroup.className = 'bbt-slideout__button-group';\n\n      if (showBackButton) {\n        const backBtn = document.createElement('button');\n        backBtn.className = 'bbt-btn bbt-btn--secondary';\n        backBtn.textContent = 'Back';\n        backBtn.onclick = (e) => {\n          e.preventDefault();\n          this.options.onPrev();\n        };\n        buttonGroup.appendChild(backBtn);\n      }\n\n      const nextBtn = document.createElement('button');\n      nextBtn.className = 'bbt-btn bbt-btn--primary';\n      nextBtn.textContent = stepIndex >= totalSteps - 1 ? 'Finish' : 'Continue';\n      nextBtn.onclick = (e) => {\n        e.preventDefault();\n        this.options.onNext();\n      };\n      buttonGroup.appendChild(nextBtn);\n\n      actions.appendChild(buttonGroup);\n    }\n\n    footer.appendChild(actions);\n    this.element.appendChild(footer);\n  }\n\n  _createMedia(media) {\n    const container = document.createElement('div');\n    container.className = 'bbt-slideout__media';\n\n    if (media.type === 'image') {\n      const img = document.createElement('img');\n      img.src = media.src;\n      img.alt = media.alt || '';\n      img.className = 'bbt-slideout__image';\n      container.appendChild(img);\n    } else if (media.type === 'video') {\n      const video = document.createElement('video');\n      video.src = media.src;\n      video.controls = true;\n      video.autoplay = media.autoplay || false;\n      video.muted = media.muted !== false;\n      video.loop = media.loop || false;\n      video.className = 'bbt-slideout__video';\n      container.appendChild(video);\n    } else if (media.type === 'embed') {\n      const iframe = document.createElement('iframe');\n      iframe.src = media.src;\n      iframe.className = 'bbt-slideout__embed';\n      iframe.allowFullscreen = true;\n      container.appendChild(iframe);\n    }\n\n    return container;\n  }\n\n  _setupListeners() {\n    this._keyHandler = (e) => {\n      if (e.key === 'Escape') {\n        this.options.onClose();\n      } else if (e.key === 'ArrowRight' || e.key === 'Enter') {\n        this.options.onNext();\n      } else if (e.key === 'ArrowLeft') {\n        this.options.onPrev();\n      }\n    };\n    document.addEventListener('keydown', this._keyHandler);\n  }\n\n  _removeListeners() {\n    if (this._keyHandler) {\n      document.removeEventListener('keydown', this._keyHandler);\n    }\n  }\n\n  _animateIn() {\n    requestAnimationFrame(() => {\n      if (this.overlayElement) {\n        this.overlayElement.classList.add('bbt-slideout-overlay--enter');\n      }\n      this.element.classList.add('bbt-slideout--enter');\n    });\n  }\n}\n","/**\n * Overlay Component\n * Creates a dark overlay with a spotlight on the target element\n */\n\nexport class Overlay {\n  constructor(options) {\n    this.options = {\n      targetElement: null,\n      onClick: null,\n      padding: 8, // Padding around highlighted element\n      opacity: 0.5,\n      theme: 'light',\n      borderRadius: 4,\n      ...options,\n    };\n\n    this.element = null;\n    this.spotlightElement = null;\n    this._resizeHandler = null;\n    this._scrollHandler = null;\n  }\n\n  render(container) {\n    this._createOverlay();\n    container.appendChild(this.element);\n\n    this._updateSpotlight();\n    this._setupListeners();\n    this._animateIn();\n  }\n\n  destroy() {\n    this._removeListeners();\n\n    if (this.element) {\n      this.element.classList.remove('bbt-overlay--enter');\n      this.element.classList.add('bbt-overlay--exit');\n\n      setTimeout(() => {\n        if (this.element && this.element.parentNode) {\n          this.element.parentNode.removeChild(this.element);\n        }\n      }, 200);\n    }\n\n    this.element = null;\n    this.spotlightElement = null;\n  }\n\n  _createOverlay() {\n    const { theme, opacity, onClick } = this.options;\n\n    // SVG-based overlay for smooth spotlight cutout\n    this.element = document.createElement('div');\n    this.element.className = `bbt-overlay bbt-overlay--${theme}`;\n\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    svg.setAttribute('class', 'bbt-overlay__svg');\n    svg.setAttribute('width', '100%');\n    svg.setAttribute('height', '100%');\n\n    // Defs for the mask\n    const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');\n\n    const mask = document.createElementNS('http://www.w3.org/2000/svg', 'mask');\n    mask.setAttribute('id', 'bbt-spotlight-mask');\n\n    // White rectangle (visible area)\n    const maskRect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    maskRect.setAttribute('x', '0');\n    maskRect.setAttribute('y', '0');\n    maskRect.setAttribute('width', '100%');\n    maskRect.setAttribute('height', '100%');\n    maskRect.setAttribute('fill', 'white');\n    mask.appendChild(maskRect);\n\n    // Black rectangle for spotlight (cutout)\n    this.spotlightElement = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    this.spotlightElement.setAttribute('class', 'bbt-overlay__spotlight');\n    this.spotlightElement.setAttribute('fill', 'black');\n    this.spotlightElement.setAttribute('rx', this.options.borderRadius);\n    this.spotlightElement.setAttribute('ry', this.options.borderRadius);\n    mask.appendChild(this.spotlightElement);\n\n    defs.appendChild(mask);\n    svg.appendChild(defs);\n\n    // Overlay rectangle with mask\n    const overlayRect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    overlayRect.setAttribute('x', '0');\n    overlayRect.setAttribute('y', '0');\n    overlayRect.setAttribute('width', '100%');\n    overlayRect.setAttribute('height', '100%');\n    overlayRect.setAttribute('fill', theme === 'dark' ? 'rgba(255, 255, 255, 0.1)' : `rgba(0, 0, 0, ${opacity})`);\n    overlayRect.setAttribute('mask', 'url(#bbt-spotlight-mask)');\n    svg.appendChild(overlayRect);\n\n    this.element.appendChild(svg);\n\n    // Click handler\n    if (onClick) {\n      this.element.onclick = (e) => {\n        if (e.target === this.element || e.target.tagName === 'svg' || e.target.tagName === 'rect') {\n          onClick();\n        }\n      };\n    }\n  }\n\n  _updateSpotlight() {\n    const { targetElement, padding } = this.options;\n\n    if (!targetElement || !this.spotlightElement) {\n      // Hide spotlight if no target\n      this.spotlightElement.setAttribute('width', '0');\n      this.spotlightElement.setAttribute('height', '0');\n      return;\n    }\n\n    const rect = targetElement.getBoundingClientRect();\n\n    this.spotlightElement.setAttribute('x', rect.left - padding);\n    this.spotlightElement.setAttribute('y', rect.top - padding);\n    this.spotlightElement.setAttribute('width', rect.width + padding * 2);\n    this.spotlightElement.setAttribute('height', rect.height + padding * 2);\n  }\n\n  _setupListeners() {\n    this._resizeHandler = () => this._updateSpotlight();\n    this._scrollHandler = () => this._updateSpotlight();\n\n    window.addEventListener('resize', this._resizeHandler);\n    window.addEventListener('scroll', this._scrollHandler, true);\n  }\n\n  _removeListeners() {\n    if (this._resizeHandler) {\n      window.removeEventListener('resize', this._resizeHandler);\n    }\n    if (this._scrollHandler) {\n      window.removeEventListener('scroll', this._scrollHandler, true);\n    }\n  }\n\n  _animateIn() {\n    requestAnimationFrame(() => {\n      this.element.classList.add('bbt-overlay--enter');\n    });\n  }\n}\n\n/**\n * Simple highlight border around element (alternative to overlay)\n */\nexport class Highlight {\n  constructor(options) {\n    this.options = {\n      targetElement: null,\n      color: '#3B82F6',\n      borderWidth: 2,\n      padding: 4,\n      borderRadius: 4,\n      pulse: false,\n      ...options,\n    };\n\n    this.element = null;\n    this._resizeHandler = null;\n    this._scrollHandler = null;\n  }\n\n  render(container) {\n    this._createHighlight();\n    container.appendChild(this.element);\n\n    this._updatePosition();\n    this._setupListeners();\n    this._animateIn();\n  }\n\n  destroy() {\n    this._removeListeners();\n\n    if (this.element && this.element.parentNode) {\n      this.element.parentNode.removeChild(this.element);\n    }\n\n    this.element = null;\n  }\n\n  _createHighlight() {\n    const { color, borderWidth, borderRadius, pulse } = this.options;\n\n    this.element = document.createElement('div');\n    this.element.className = 'bbt-highlight';\n\n    if (pulse) {\n      this.element.classList.add('bbt-highlight--pulse');\n    }\n\n    this.element.style.border = `${borderWidth}px solid ${color}`;\n    this.element.style.borderRadius = `${borderRadius}px`;\n    this.element.style.boxShadow = `0 0 0 4px ${color}33`;\n  }\n\n  _updatePosition() {\n    const { targetElement, padding, borderWidth } = this.options;\n\n    if (!targetElement) return;\n\n    const rect = targetElement.getBoundingClientRect();\n\n    this.element.style.position = 'fixed';\n    this.element.style.top = `${rect.top - padding - borderWidth}px`;\n    this.element.style.left = `${rect.left - padding - borderWidth}px`;\n    this.element.style.width = `${rect.width + padding * 2}px`;\n    this.element.style.height = `${rect.height + padding * 2}px`;\n  }\n\n  _setupListeners() {\n    this._resizeHandler = () => this._updatePosition();\n    this._scrollHandler = () => this._updatePosition();\n\n    window.addEventListener('resize', this._resizeHandler);\n    window.addEventListener('scroll', this._scrollHandler, true);\n  }\n\n  _removeListeners() {\n    if (this._resizeHandler) {\n      window.removeEventListener('resize', this._resizeHandler);\n    }\n    if (this._scrollHandler) {\n      window.removeEventListener('scroll', this._scrollHandler, true);\n    }\n  }\n\n  _animateIn() {\n    requestAnimationFrame(() => {\n      this.element.classList.add('bbt-highlight--enter');\n    });\n  }\n}\n","/**\n * ProgressBar Component\n * Shows tour progress at the bottom of the screen\n */\n\nexport class ProgressBar {\n  constructor(options) {\n    this.options = {\n      current: 0,\n      total: 1,\n      theme: 'light',\n      position: 'bottom', // top, bottom\n      showStepNumbers: true,\n      primaryColor: null,\n      ...options,\n    };\n\n    this.element = null;\n  }\n\n  render(container) {\n    this._createProgressBar();\n    container.appendChild(this.element);\n    this._animateIn();\n  }\n\n  destroy() {\n    if (this.element) {\n      this.element.classList.remove('bbt-progress-bar--enter');\n      this.element.classList.add('bbt-progress-bar--exit');\n\n      setTimeout(() => {\n        if (this.element && this.element.parentNode) {\n          this.element.parentNode.removeChild(this.element);\n        }\n      }, 200);\n    }\n\n    this.element = null;\n  }\n\n  update(current) {\n    this.options.current = current;\n    this._updateProgress();\n  }\n\n  _createProgressBar() {\n    const { current, total, theme, position, showStepNumbers, primaryColor } = this.options;\n\n    this.element = document.createElement('div');\n    this.element.className = `bbt-progress-bar bbt-progress-bar--${position} bbt-progress-bar--${theme}`;\n\n    if (primaryColor) {\n      this.element.style.setProperty('--bbt-primary-color', primaryColor);\n    }\n\n    // Progress track\n    const track = document.createElement('div');\n    track.className = 'bbt-progress-bar__track';\n\n    // Step dots\n    for (let i = 0; i < total; i++) {\n      const step = document.createElement('div');\n      step.className = 'bbt-progress-bar__step';\n\n      if (i < current) {\n        step.classList.add('bbt-progress-bar__step--completed');\n      } else if (i === current) {\n        step.classList.add('bbt-progress-bar__step--active');\n      }\n\n      // Connector line (except for last step)\n      if (i < total - 1) {\n        const connector = document.createElement('div');\n        connector.className = 'bbt-progress-bar__connector';\n\n        if (i < current) {\n          connector.classList.add('bbt-progress-bar__connector--completed');\n        }\n\n        step.appendChild(connector);\n      }\n\n      // Step dot\n      const dot = document.createElement('div');\n      dot.className = 'bbt-progress-bar__dot';\n\n      if (showStepNumbers) {\n        dot.textContent = i + 1;\n      }\n\n      step.appendChild(dot);\n      track.appendChild(step);\n    }\n\n    this.element.appendChild(track);\n\n    // Text indicator\n    const text = document.createElement('div');\n    text.className = 'bbt-progress-bar__text';\n    text.textContent = `Step ${current + 1} of ${total}`;\n    this.element.appendChild(text);\n  }\n\n  _updateProgress() {\n    const { current, total } = this.options;\n\n    // Update steps\n    const steps = this.element.querySelectorAll('.bbt-progress-bar__step');\n    steps.forEach((step, i) => {\n      step.classList.remove('bbt-progress-bar__step--completed', 'bbt-progress-bar__step--active');\n\n      if (i < current) {\n        step.classList.add('bbt-progress-bar__step--completed');\n      } else if (i === current) {\n        step.classList.add('bbt-progress-bar__step--active');\n      }\n    });\n\n    // Update connectors\n    const connectors = this.element.querySelectorAll('.bbt-progress-bar__connector');\n    connectors.forEach((connector, i) => {\n      connector.classList.toggle('bbt-progress-bar__connector--completed', i < current);\n    });\n\n    // Update text\n    const text = this.element.querySelector('.bbt-progress-bar__text');\n    if (text) {\n      text.textContent = `Step ${current + 1} of ${total}`;\n    }\n  }\n\n  _animateIn() {\n    requestAnimationFrame(() => {\n      this.element.classList.add('bbt-progress-bar--enter');\n    });\n  }\n}\n\n/**\n * Minimal progress indicator (dots only)\n */\nexport class ProgressDots {\n  constructor(options) {\n    this.options = {\n      current: 0,\n      total: 1,\n      theme: 'light',\n      primaryColor: null,\n      ...options,\n    };\n\n    this.element = null;\n  }\n\n  render(container) {\n    this._createDots();\n    container.appendChild(this.element);\n  }\n\n  destroy() {\n    if (this.element && this.element.parentNode) {\n      this.element.parentNode.removeChild(this.element);\n    }\n    this.element = null;\n  }\n\n  update(current) {\n    this.options.current = current;\n    this._updateDots();\n  }\n\n  _createDots() {\n    const { current, total, theme, primaryColor } = this.options;\n\n    this.element = document.createElement('div');\n    this.element.className = `bbt-progress-dots bbt-progress-dots--${theme}`;\n\n    if (primaryColor) {\n      this.element.style.setProperty('--bbt-primary-color', primaryColor);\n    }\n\n    for (let i = 0; i < total; i++) {\n      const dot = document.createElement('div');\n      dot.className = 'bbt-progress-dots__dot';\n\n      if (i < current) {\n        dot.classList.add('bbt-progress-dots__dot--completed');\n      } else if (i === current) {\n        dot.classList.add('bbt-progress-dots__dot--active');\n      }\n\n      this.element.appendChild(dot);\n    }\n  }\n\n  _updateDots() {\n    const { current } = this.options;\n\n    const dots = this.element.querySelectorAll('.bbt-progress-dots__dot');\n    dots.forEach((dot, i) => {\n      dot.classList.remove('bbt-progress-dots__dot--completed', 'bbt-progress-dots__dot--active');\n\n      if (i < current) {\n        dot.classList.add('bbt-progress-dots__dot--completed');\n      } else if (i === current) {\n        dot.classList.add('bbt-progress-dots__dot--active');\n      }\n    });\n  }\n}\n","/**\n * DOM Utilities\n * Helper functions for DOM manipulation and element finding\n */\n\n/**\n * Find an element by selector\n * @param {string} selector - CSS selector\n * @returns {Element|null}\n */\nexport function findElement(selector) {\n  if (!selector) return null;\n\n  try {\n    // Handle special selectors\n    if (selector.startsWith('data-tour=')) {\n      const value = selector.replace('data-tour=', '');\n      return document.querySelector(`[data-tour=\"${value}\"]`);\n    }\n\n    if (selector.startsWith('data-tour-id=')) {\n      const value = selector.replace('data-tour-id=', '');\n      return document.querySelector(`[data-tour-id=\"${value}\"]`);\n    }\n\n    return document.querySelector(selector);\n  } catch (error) {\n    console.error('[TourSDK] Invalid selector:', selector, error);\n    return null;\n  }\n}\n\n/**\n * Check if an element is visible in the viewport\n * @param {Element} element - DOM element\n * @returns {boolean}\n */\nexport function isElementVisible(element) {\n  if (!element) return false;\n\n  const rect = element.getBoundingClientRect();\n  const style = window.getComputedStyle(element);\n\n  // Check if element has dimensions\n  if (rect.width === 0 || rect.height === 0) return false;\n\n  // Check CSS visibility\n  if (style.display === 'none') return false;\n  if (style.visibility === 'hidden') return false;\n  if (parseFloat(style.opacity) === 0) return false;\n\n  // Check if in viewport\n  const viewportHeight = window.innerHeight || document.documentElement.clientHeight;\n  const viewportWidth = window.innerWidth || document.documentElement.clientWidth;\n\n  return (\n    rect.top >= -rect.height &&\n    rect.left >= -rect.width &&\n    rect.bottom <= viewportHeight + rect.height &&\n    rect.right <= viewportWidth + rect.width\n  );\n}\n\n/**\n * Check if element is fully visible in viewport\n * @param {Element} element - DOM element\n * @returns {boolean}\n */\nexport function isElementFullyVisible(element) {\n  if (!element) return false;\n\n  const rect = element.getBoundingClientRect();\n  const viewportHeight = window.innerHeight || document.documentElement.clientHeight;\n  const viewportWidth = window.innerWidth || document.documentElement.clientWidth;\n\n  return (\n    rect.top >= 0 &&\n    rect.left >= 0 &&\n    rect.bottom <= viewportHeight &&\n    rect.right <= viewportWidth\n  );\n}\n\n/**\n * Get element position and dimensions\n * @param {Element} element - DOM element\n * @returns {Object}\n */\nexport function getElementPosition(element) {\n  if (!element) return null;\n\n  const rect = element.getBoundingClientRect();\n  const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;\n  const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\n\n  return {\n    top: rect.top,\n    left: rect.left,\n    right: rect.right,\n    bottom: rect.bottom,\n    width: rect.width,\n    height: rect.height,\n    absoluteTop: rect.top + scrollTop,\n    absoluteLeft: rect.left + scrollLeft,\n    centerX: rect.left + rect.width / 2,\n    centerY: rect.top + rect.height / 2,\n  };\n}\n\n/**\n * Scroll to an element\n * @param {Element} element - DOM element\n * @param {Object} options - Scroll options\n * @returns {Promise}\n */\nexport function scrollToElement(element, options = {}) {\n  return new Promise((resolve) => {\n    if (!element) {\n      resolve();\n      return;\n    }\n\n    const {\n      behavior = 'smooth',\n      block = 'center',\n      inline = 'nearest',\n      offset = 0,\n    } = options;\n\n    // Check if element is already visible\n    if (isElementFullyVisible(element)) {\n      resolve();\n      return;\n    }\n\n    // Use native scrollIntoView\n    element.scrollIntoView({\n      behavior,\n      block,\n      inline,\n    });\n\n    // Apply additional offset if needed\n    if (offset !== 0) {\n      setTimeout(() => {\n        window.scrollBy({\n          top: offset,\n          behavior: 'smooth',\n        });\n      }, 100);\n    }\n\n    // Wait for scroll to complete\n    const scrollTimeout = behavior === 'smooth' ? 500 : 100;\n    setTimeout(resolve, scrollTimeout);\n  });\n}\n\n/**\n * Wait for an element to appear in the DOM\n * @param {string} selector - CSS selector\n * @param {number} timeout - Timeout in milliseconds\n * @returns {Promise<Element|null>}\n */\nexport function waitForElement(selector, timeout = 5000) {\n  return new Promise((resolve) => {\n    // Check if element already exists\n    const existing = findElement(selector);\n    if (existing) {\n      resolve(existing);\n      return;\n    }\n\n    const startTime = Date.now();\n\n    // Use MutationObserver for better performance\n    const observer = new MutationObserver((mutations, obs) => {\n      const element = findElement(selector);\n      if (element) {\n        obs.disconnect();\n        resolve(element);\n      } else if (Date.now() - startTime >= timeout) {\n        obs.disconnect();\n        resolve(null);\n      }\n    });\n\n    observer.observe(document.body, {\n      childList: true,\n      subtree: true,\n      attributes: true,\n    });\n\n    // Fallback timeout\n    setTimeout(() => {\n      observer.disconnect();\n      resolve(findElement(selector));\n    }, timeout);\n  });\n}\n\n/**\n * Wait for element to be visible\n * @param {string} selector - CSS selector\n * @param {number} timeout - Timeout in milliseconds\n * @returns {Promise<Element|null>}\n */\nexport async function waitForElementVisible(selector, timeout = 5000) {\n  const element = await waitForElement(selector, timeout);\n\n  if (!element) return null;\n\n  // Wait for visibility\n  const startTime = Date.now();\n  while (!isElementVisible(element) && Date.now() - startTime < timeout) {\n    await new Promise((resolve) => setTimeout(resolve, 100));\n  }\n\n  return isElementVisible(element) ? element : null;\n}\n\n/**\n * Add highlight effect to an element\n * @param {Element} element - DOM element\n * @param {Object} options - Highlight options\n * @returns {Function} - Cleanup function\n */\nexport function highlightElement(element, options = {}) {\n  if (!element) return () => {};\n\n  const {\n    color = '#3B82F6',\n    duration = 0, // 0 = permanent until cleanup\n    pulse = false,\n  } = options;\n\n  const originalOutline = element.style.outline;\n  const originalTransition = element.style.transition;\n\n  element.style.outline = `3px solid ${color}`;\n  element.style.transition = 'outline 0.3s ease';\n\n  if (pulse) {\n    element.classList.add('bbt-pulse-highlight');\n  }\n\n  const cleanup = () => {\n    element.style.outline = originalOutline;\n    element.style.transition = originalTransition;\n    element.classList.remove('bbt-pulse-highlight');\n  };\n\n  if (duration > 0) {\n    setTimeout(cleanup, duration);\n  }\n\n  return cleanup;\n}\n\n/**\n * Get all focusable elements within a container\n * @param {Element} container - Container element\n * @returns {Element[]}\n */\nexport function getFocusableElements(container) {\n  const focusableSelectors = [\n    'a[href]',\n    'button:not([disabled])',\n    'input:not([disabled])',\n    'select:not([disabled])',\n    'textarea:not([disabled])',\n    '[tabindex]:not([tabindex=\"-1\"])',\n  ].join(', ');\n\n  return Array.from(container.querySelectorAll(focusableSelectors));\n}\n\n/**\n * Create focus trap within a container\n * @param {Element} container - Container element\n * @returns {Function} - Cleanup function\n */\nexport function createFocusTrap(container) {\n  const focusableElements = getFocusableElements(container);\n  const firstElement = focusableElements[0];\n  const lastElement = focusableElements[focusableElements.length - 1];\n\n  const handleKeyDown = (e) => {\n    if (e.key !== 'Tab') return;\n\n    if (e.shiftKey) {\n      if (document.activeElement === firstElement) {\n        e.preventDefault();\n        lastElement?.focus();\n      }\n    } else {\n      if (document.activeElement === lastElement) {\n        e.preventDefault();\n        firstElement?.focus();\n      }\n    }\n  };\n\n  container.addEventListener('keydown', handleKeyDown);\n  firstElement?.focus();\n\n  return () => {\n    container.removeEventListener('keydown', handleKeyDown);\n  };\n}\n\n/**\n * Get the z-index of an element\n * @param {Element} element - DOM element\n * @returns {number}\n */\nexport function getZIndex(element) {\n  let el = element;\n  let zIndex = 0;\n\n  while (el) {\n    const style = window.getComputedStyle(el);\n    const z = parseInt(style.zIndex, 10);\n\n    if (!isNaN(z) && z > zIndex) {\n      zIndex = z;\n    }\n\n    el = el.parentElement;\n  }\n\n  return zIndex;\n}\n","/**\n * TourRenderer - Handles rendering of tour steps and UI components\n */\n\nimport { Tooltip } from './components/Tooltip';\nimport { Modal } from './components/Modal';\nimport { Hotspot } from './components/Hotspot';\nimport { Slideout } from './components/Slideout';\nimport { Overlay } from './components/Overlay';\nimport { ProgressBar } from './components/ProgressBar';\nimport { findElement, waitForElement, scrollToElement, isElementVisible } from './utils/dom';\n\nexport class TourRenderer {\n  constructor(sdk) {\n    this.sdk = sdk;\n    this.container = null;\n    this.currentComponent = null;\n    this.overlay = null;\n    this.progressBar = null;\n    this.hotspots = [];\n\n    this._createContainer();\n  }\n\n  /**\n   * Render a step\n   * @param {Object} step - Step configuration\n   * @param {Object} options - Render options\n   */\n  async renderStep(step, options) {\n    // Cleanup previous step\n    this._cleanup();\n\n    const { tour, stepIndex, totalSteps, onNext, onPrev, onSkip, onClose } = options;\n\n    // Wait for target element if needed\n    let targetElement = null;\n    if (step.targetSelector) {\n      targetElement = await waitForElement(step.targetSelector, step.waitTimeout || 5000);\n\n      if (!targetElement) {\n        console.warn(`[TourRenderer] Target element not found: ${step.targetSelector}`);\n        // Show modal instead if target not found\n        step.type = 'modal';\n      }\n    }\n\n    // Scroll to element if needed\n    if (targetElement && step.scrollTo !== false) {\n      await scrollToElement(targetElement, {\n        behavior: step.scrollBehavior || 'smooth',\n        block: step.scrollBlock || 'center',\n      });\n    }\n\n    // Show overlay if configured\n    if (step.overlay !== false && targetElement) {\n      this.overlay = new Overlay({\n        targetElement,\n        onClick: step.overlayClickClose ? onClose : null,\n        padding: step.overlayPadding || 8,\n        opacity: step.overlayOpacity || 0.5,\n        theme: this.sdk.config.theme,\n      });\n      this.overlay.render(this.container);\n    }\n\n    // Show progress bar if configured\n    if (tour.settings?.showProgress !== false && totalSteps > 1) {\n      this.progressBar = new ProgressBar({\n        current: stepIndex,\n        total: totalSteps,\n        theme: this.sdk.config.theme,\n      });\n      this.progressBar.render(this.container);\n    }\n\n    // Render the appropriate component based on step type\n    const componentOptions = {\n      step,\n      targetElement,\n      stepIndex,\n      totalSteps,\n      onNext,\n      onPrev,\n      onSkip,\n      onClose,\n      showBackButton: stepIndex > 0 && tour.settings?.showBackButton !== false,\n      showSkipButton: tour.settings?.showSkipButton !== false,\n      theme: this.sdk.config.theme,\n      primaryColor: tour.settings?.primaryColor,\n    };\n\n    switch (step.type) {\n      case 'tooltip':\n        this._renderTooltip(componentOptions);\n        break;\n      case 'modal':\n        this._renderModal(componentOptions);\n        break;\n      case 'hotspot':\n        this._renderHotspot(componentOptions);\n        break;\n      case 'slideout':\n        this._renderSlideout(componentOptions);\n        break;\n      default:\n        this._renderTooltip(componentOptions);\n    }\n\n    // Handle step actions/triggers\n    this._setupStepTriggers(step, targetElement, onNext);\n  }\n\n  /**\n   * Render tooltip component\n   */\n  _renderTooltip(options) {\n    const { step, targetElement, ...rest } = options;\n\n    this.currentComponent = new Tooltip({\n      title: step.title,\n      content: step.content,\n      position: step.position || 'bottom',\n      targetElement,\n      media: step.media,\n      buttons: step.buttons,\n      ...rest,\n    });\n\n    this.currentComponent.render(this.container);\n  }\n\n  /**\n   * Render modal component\n   */\n  _renderModal(options) {\n    const { step, ...rest } = options;\n\n    this.currentComponent = new Modal({\n      title: step.title,\n      content: step.content,\n      size: step.size || 'medium',\n      media: step.media,\n      buttons: step.buttons,\n      ...rest,\n    });\n\n    this.currentComponent.render(this.container);\n  }\n\n  /**\n   * Render hotspot component\n   */\n  _renderHotspot(options) {\n    const { step, targetElement, ...rest } = options;\n\n    if (!targetElement) {\n      console.warn('[TourRenderer] Hotspot requires a target element');\n      this._renderModal(options);\n      return;\n    }\n\n    this.currentComponent = new Hotspot({\n      targetElement,\n      title: step.title,\n      content: step.content,\n      position: step.position || 'right',\n      color: step.hotspotColor,\n      pulse: step.pulse !== false,\n      ...rest,\n    });\n\n    this.currentComponent.render(this.container);\n  }\n\n  /**\n   * Render slideout component\n   */\n  _renderSlideout(options) {\n    const { step, ...rest } = options;\n\n    this.currentComponent = new Slideout({\n      title: step.title,\n      content: step.content,\n      position: step.slidePosition || 'right',\n      width: step.slideWidth,\n      media: step.media,\n      buttons: step.buttons,\n      ...rest,\n    });\n\n    this.currentComponent.render(this.container);\n  }\n\n  /**\n   * Setup step-specific triggers\n   */\n  _setupStepTriggers(step, targetElement, onNext) {\n    if (!step.trigger || !targetElement) return;\n\n    const { type, event } = step.trigger;\n\n    switch (type) {\n      case 'click':\n        const clickHandler = () => {\n          targetElement.removeEventListener('click', clickHandler);\n          onNext();\n        };\n        targetElement.addEventListener('click', clickHandler);\n        this._triggerCleanup = () => targetElement.removeEventListener('click', clickHandler);\n        break;\n\n      case 'input':\n        const inputHandler = () => {\n          if (targetElement.value.length > 0) {\n            targetElement.removeEventListener('input', inputHandler);\n            onNext();\n          }\n        };\n        targetElement.addEventListener('input', inputHandler);\n        this._triggerCleanup = () => targetElement.removeEventListener('input', inputHandler);\n        break;\n\n      case 'custom':\n        // Custom event listener\n        if (event) {\n          const customHandler = () => {\n            document.removeEventListener(event, customHandler);\n            onNext();\n          };\n          document.addEventListener(event, customHandler);\n          this._triggerCleanup = () => document.removeEventListener(event, customHandler);\n        }\n        break;\n    }\n  }\n\n  /**\n   * Destroy all rendered components\n   */\n  destroy() {\n    this._cleanup();\n\n    if (this.container && this.container.parentNode) {\n      this.container.parentNode.removeChild(this.container);\n    }\n\n    this.container = null;\n  }\n\n  // Private methods\n\n  _createContainer() {\n    // Remove existing container if any\n    const existing = document.getElementById('botbuilder-tours-container');\n    if (existing) {\n      existing.parentNode.removeChild(existing);\n    }\n\n    this.container = document.createElement('div');\n    this.container.id = 'botbuilder-tours-container';\n    this.container.className = 'botbuilder-tours';\n    document.body.appendChild(this.container);\n  }\n\n  _cleanup() {\n    if (this.currentComponent) {\n      this.currentComponent.destroy();\n      this.currentComponent = null;\n    }\n\n    if (this.overlay) {\n      this.overlay.destroy();\n      this.overlay = null;\n    }\n\n    if (this.progressBar) {\n      this.progressBar.destroy();\n      this.progressBar = null;\n    }\n\n    this.hotspots.forEach((hotspot) => hotspot.destroy());\n    this.hotspots = [];\n\n    if (this._triggerCleanup) {\n      this._triggerCleanup();\n      this._triggerCleanup = null;\n    }\n  }\n}\n","/**\n * Event Emitter\n * Simple event emitter for SDK events\n */\n\nexport class EventEmitter {\n  constructor() {\n    this._events = {};\n    this._onceEvents = {};\n  }\n\n  /**\n   * Add an event listener\n   * @param {string} event - Event name\n   * @param {Function} callback - Callback function\n   * @returns {this}\n   */\n  on(event, callback) {\n    if (typeof callback !== 'function') {\n      throw new Error('Callback must be a function');\n    }\n\n    if (!this._events[event]) {\n      this._events[event] = [];\n    }\n\n    this._events[event].push(callback);\n    return this;\n  }\n\n  /**\n   * Add a one-time event listener\n   * @param {string} event - Event name\n   * @param {Function} callback - Callback function\n   * @returns {this}\n   */\n  once(event, callback) {\n    if (typeof callback !== 'function') {\n      throw new Error('Callback must be a function');\n    }\n\n    if (!this._onceEvents[event]) {\n      this._onceEvents[event] = [];\n    }\n\n    this._onceEvents[event].push(callback);\n    return this;\n  }\n\n  /**\n   * Remove an event listener\n   * @param {string} event - Event name\n   * @param {Function} callback - Callback function to remove\n   * @returns {this}\n   */\n  off(event, callback) {\n    if (this._events[event]) {\n      this._events[event] = this._events[event].filter((cb) => cb !== callback);\n    }\n\n    if (this._onceEvents[event]) {\n      this._onceEvents[event] = this._onceEvents[event].filter((cb) => cb !== callback);\n    }\n\n    return this;\n  }\n\n  /**\n   * Remove all listeners for an event (or all events)\n   * @param {string} [event] - Event name (optional)\n   * @returns {this}\n   */\n  removeAllListeners(event) {\n    if (event) {\n      delete this._events[event];\n      delete this._onceEvents[event];\n    } else {\n      this._events = {};\n      this._onceEvents = {};\n    }\n\n    return this;\n  }\n\n  /**\n   * Emit an event\n   * @param {string} event - Event name\n   * @param {...*} args - Arguments to pass to callbacks\n   * @returns {boolean} - Whether event had listeners\n   */\n  emit(event, ...args) {\n    let hasListeners = false;\n\n    // Regular listeners\n    if (this._events[event]) {\n      hasListeners = true;\n      this._events[event].forEach((callback) => {\n        try {\n          callback(...args);\n        } catch (error) {\n          console.error(`[EventEmitter] Error in ${event} listener:`, error);\n        }\n      });\n    }\n\n    // One-time listeners\n    if (this._onceEvents[event]) {\n      hasListeners = true;\n      const callbacks = [...this._onceEvents[event]];\n      this._onceEvents[event] = [];\n\n      callbacks.forEach((callback) => {\n        try {\n          callback(...args);\n        } catch (error) {\n          console.error(`[EventEmitter] Error in ${event} once listener:`, error);\n        }\n      });\n    }\n\n    // Wildcard listeners\n    if (this._events['*']) {\n      this._events['*'].forEach((callback) => {\n        try {\n          callback(event, ...args);\n        } catch (error) {\n          console.error(`[EventEmitter] Error in wildcard listener:`, error);\n        }\n      });\n    }\n\n    return hasListeners;\n  }\n\n  /**\n   * Get listener count for an event\n   * @param {string} event - Event name\n   * @returns {number}\n   */\n  listenerCount(event) {\n    const regular = this._events[event]?.length || 0;\n    const once = this._onceEvents[event]?.length || 0;\n    return regular + once;\n  }\n\n  /**\n   * Get all event names\n   * @returns {string[]}\n   */\n  eventNames() {\n    const events = new Set([\n      ...Object.keys(this._events),\n      ...Object.keys(this._onceEvents),\n    ]);\n    return Array.from(events);\n  }\n\n  /**\n   * Get listeners for an event\n   * @param {string} event - Event name\n   * @returns {Function[]}\n   */\n  listeners(event) {\n    return [\n      ...(this._events[event] || []),\n      ...(this._onceEvents[event] || []),\n    ];\n  }\n}\n\n/**\n * SDK Event Types\n */\nexport const EVENTS = {\n  // SDK lifecycle\n  SDK_INITIALIZED: 'sdk:initialized',\n  SDK_DESTROYED: 'sdk:destroyed',\n\n  // User events\n  USER_IDENTIFIED: 'user:identified',\n\n  // Tour events\n  TOUR_STARTED: 'tour:started',\n  TOUR_COMPLETED: 'tour:completed',\n  TOUR_DISMISSED: 'tour:dismissed',\n  TOUR_ERROR: 'tour:error',\n\n  // Step events\n  STEP_VIEWED: 'step:viewed',\n  STEP_COMPLETED: 'step:completed',\n  STEP_SKIPPED: 'step:skipped',\n\n  // Progress events\n  PROGRESS_SAVED: 'progress:saved',\n  PROGRESS_RESET: 'progress:reset',\n};\n\n/**\n * Create a typed event emitter with predefined events\n */\nexport function createTypedEmitter() {\n  const emitter = new EventEmitter();\n\n  // Add type hints for IDE autocomplete\n  return {\n    on: (event, callback) => emitter.on(event, callback),\n    once: (event, callback) => emitter.once(event, callback),\n    off: (event, callback) => emitter.off(event, callback),\n    emit: (event, ...args) => emitter.emit(event, ...args),\n    removeAllListeners: (event) => emitter.removeAllListeners(event),\n    EVENTS,\n  };\n}\n\n/**\n * Debounce helper\n * @param {Function} func - Function to debounce\n * @param {number} wait - Wait time in milliseconds\n * @returns {Function}\n */\nexport function debounce(func, wait) {\n  let timeout;\n\n  return function executedFunction(...args) {\n    const later = () => {\n      clearTimeout(timeout);\n      func(...args);\n    };\n\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n}\n\n/**\n * Throttle helper\n * @param {Function} func - Function to throttle\n * @param {number} limit - Time limit in milliseconds\n * @returns {Function}\n */\nexport function throttle(func, limit) {\n  let inThrottle;\n\n  return function executedFunction(...args) {\n    if (!inThrottle) {\n      func(...args);\n      inThrottle = true;\n      setTimeout(() => (inThrottle = false), limit);\n    }\n  };\n}\n","/**\n * BotBuilder Tours SDK\n * Product tours for customer websites\n */\n\nimport { TourEngine } from './TourEngine';\nimport { TourRenderer } from './TourRenderer';\nimport { EventEmitter } from './utils/events';\nimport { getVisitorId, setVisitorId, getProgress, setProgress, clearProgress } from './utils/storage';\nimport { initApi } from './utils/api';\n\nclass TourSDK extends EventEmitter {\n  constructor() {\n    super();\n    this.config = null;\n    this.engine = null;\n    this.renderer = null;\n    this.currentTour = null;\n    this.currentStepIndex = 0;\n    this.initialized = false;\n    this.visitorId = null;\n    this.userId = null;\n    this.userTraits = {};\n  }\n\n  /**\n   * Initialize the SDK\n   * @param {Object} config - Configuration object\n   * @param {string} config.workspaceId - Workspace ID (required)\n   * @param {string} [config.userId] - User ID (optional)\n   * @param {string} [config.visitorId] - Visitor ID (optional, auto-generated if not provided)\n   * @param {string} [config.apiUrl] - API URL (optional, defaults to production)\n   * @param {boolean} [config.autoStart=true] - Auto start tours based on targeting\n   * @param {string} [config.theme='light'] - Theme: 'light' or 'dark'\n   */\n  init(config) {\n    if (this.initialized) {\n      console.warn('[BotBuilderTours] SDK already initialized');\n      return this;\n    }\n\n    if (!config.workspaceId) {\n      throw new Error('[BotBuilderTours] workspaceId is required');\n    }\n\n    this.config = {\n      workspaceId: config.workspaceId,\n      userId: config.userId || null,\n      visitorId: config.visitorId || getVisitorId(),\n      apiUrl: config.apiUrl || 'https://api.botbuilder.app',\n      autoStart: config.autoStart !== false,\n      theme: config.theme || 'light',\n    };\n\n    // Save visitor ID\n    this.visitorId = this.config.visitorId;\n    setVisitorId(this.visitorId);\n\n    if (this.config.userId) {\n      this.userId = this.config.userId;\n    }\n\n    // Initialize API\n    initApi(this.config.apiUrl, this.config.workspaceId);\n\n    // Initialize engine and renderer\n    this.engine = new TourEngine(this);\n    this.renderer = new TourRenderer(this);\n\n    // Apply theme\n    this._applyTheme(this.config.theme);\n\n    this.initialized = true;\n    this.emit('sdk:initialized', { config: this.config });\n\n    // Auto-load and start tours if enabled\n    if (this.config.autoStart) {\n      this._autoStartTours();\n    }\n\n    return this;\n  }\n\n  /**\n   * Identify a user\n   * @param {string} userId - User ID\n   * @param {Object} [traits] - User traits for targeting\n   */\n  identify(userId, traits = {}) {\n    if (!this.initialized) {\n      throw new Error('[BotBuilderTours] SDK not initialized. Call init() first.');\n    }\n\n    this.userId = userId;\n    this.userTraits = { ...this.userTraits, ...traits };\n\n    this.emit('user:identified', { userId, traits: this.userTraits });\n\n    // Re-check targeting after identification\n    if (this.config.autoStart) {\n      this._autoStartTours();\n    }\n\n    return this;\n  }\n\n  /**\n   * Manually start a tour\n   * @param {string} tourId - Tour ID\n   */\n  async startTour(tourId) {\n    if (!this.initialized) {\n      throw new Error('[BotBuilderTours] SDK not initialized. Call init() first.');\n    }\n\n    if (this.currentTour) {\n      console.warn('[BotBuilderTours] A tour is already running. End it first.');\n      return;\n    }\n\n    try {\n      const tour = await this.engine.loadTour(tourId);\n      if (!tour) {\n        console.error(`[BotBuilderTours] Tour ${tourId} not found`);\n        return;\n      }\n\n      this.currentTour = tour;\n      this.currentStepIndex = 0;\n\n      // Check for saved progress\n      const progress = getProgress(tourId);\n      if (progress && progress.currentStep > 0) {\n        this.currentStepIndex = progress.currentStep;\n      }\n\n      this.emit('tour:started', { tour: this.currentTour, stepIndex: this.currentStepIndex });\n      this.engine.trackEvent('tour_started', { tourId });\n\n      this._showCurrentStep();\n    } catch (error) {\n      console.error('[BotBuilderTours] Failed to start tour:', error);\n      this.emit('tour:error', { tourId, error });\n    }\n  }\n\n  /**\n   * End the current tour\n   * @param {boolean} [completed=true] - Whether tour was completed or dismissed\n   */\n  endTour(completed = true) {\n    if (!this.currentTour) {\n      return;\n    }\n\n    const tour = this.currentTour;\n    const eventType = completed ? 'tour:completed' : 'tour:dismissed';\n\n    this.renderer.destroy();\n\n    this.engine.trackEvent(completed ? 'tour_completed' : 'tour_dismissed', {\n      tourId: tour.id,\n      completedSteps: this.currentStepIndex + 1,\n      totalSteps: tour.steps.length,\n    });\n\n    if (completed) {\n      this.engine.saveProgress(tour.id, tour.steps.length - 1, 'completed');\n    }\n\n    this.emit(eventType, { tour, completedSteps: this.currentStepIndex + 1 });\n\n    this.currentTour = null;\n    this.currentStepIndex = 0;\n  }\n\n  /**\n   * Go to next step\n   */\n  nextStep() {\n    if (!this.currentTour) {\n      return;\n    }\n\n    const tour = this.currentTour;\n\n    if (this.currentStepIndex >= tour.steps.length - 1) {\n      // Last step, complete the tour\n      this.endTour(true);\n      return;\n    }\n\n    this.emit('step:completed', {\n      tour,\n      step: tour.steps[this.currentStepIndex],\n      stepIndex: this.currentStepIndex,\n    });\n\n    this.currentStepIndex++;\n    this.engine.saveProgress(tour.id, this.currentStepIndex, 'in_progress');\n\n    this._showCurrentStep();\n  }\n\n  /**\n   * Go to previous step\n   */\n  prevStep() {\n    if (!this.currentTour || this.currentStepIndex === 0) {\n      return;\n    }\n\n    this.currentStepIndex--;\n    this._showCurrentStep();\n  }\n\n  /**\n   * Skip the current tour\n   */\n  skipTour() {\n    if (!this.currentTour) {\n      return;\n    }\n\n    this.engine.saveProgress(this.currentTour.id, this.currentStepIndex, 'skipped');\n    this.endTour(false);\n  }\n\n  /**\n   * Go to a specific step\n   * @param {number} stepIndex - Step index (0-based)\n   */\n  goToStep(stepIndex) {\n    if (!this.currentTour) {\n      return;\n    }\n\n    if (stepIndex < 0 || stepIndex >= this.currentTour.steps.length) {\n      console.warn('[BotBuilderTours] Invalid step index');\n      return;\n    }\n\n    this.currentStepIndex = stepIndex;\n    this._showCurrentStep();\n  }\n\n  /**\n   * Get current tour state\n   */\n  getState() {\n    return {\n      initialized: this.initialized,\n      currentTour: this.currentTour,\n      currentStepIndex: this.currentStepIndex,\n      totalSteps: this.currentTour?.steps.length || 0,\n      userId: this.userId,\n      visitorId: this.visitorId,\n    };\n  }\n\n  /**\n   * Reset progress for a tour\n   * @param {string} tourId - Tour ID\n   */\n  resetProgress(tourId) {\n    clearProgress(tourId);\n    this.emit('progress:reset', { tourId });\n  }\n\n  /**\n   * Destroy the SDK instance\n   */\n  destroy() {\n    if (this.currentTour) {\n      this.endTour(false);\n    }\n\n    if (this.renderer) {\n      this.renderer.destroy();\n    }\n\n    this.removeAllListeners();\n    this.initialized = false;\n    this.config = null;\n    this.engine = null;\n    this.renderer = null;\n\n    this.emit('sdk:destroyed');\n  }\n\n  // Private methods\n\n  _showCurrentStep() {\n    const step = this.currentTour.steps[this.currentStepIndex];\n\n    this.renderer.renderStep(step, {\n      tour: this.currentTour,\n      stepIndex: this.currentStepIndex,\n      totalSteps: this.currentTour.steps.length,\n      onNext: () => this.nextStep(),\n      onPrev: () => this.prevStep(),\n      onSkip: () => this.skipTour(),\n      onClose: () => this.endTour(false),\n    });\n\n    this.emit('step:viewed', {\n      tour: this.currentTour,\n      step,\n      stepIndex: this.currentStepIndex,\n    });\n\n    this.engine.trackEvent('step_viewed', {\n      tourId: this.currentTour.id,\n      stepId: step.id,\n      stepIndex: this.currentStepIndex,\n    });\n  }\n\n  async _autoStartTours() {\n    try {\n      const tours = await this.engine.loadActiveTours();\n\n      for (const tour of tours) {\n        const context = {\n          url: window.location.href,\n          pathname: window.location.pathname,\n          userId: this.userId,\n          visitorId: this.visitorId,\n          userTraits: this.userTraits,\n        };\n\n        if (this.engine.shouldShowTour(tour, context)) {\n          await this.startTour(tour.id);\n          break; // Only start one tour at a time\n        }\n      }\n    } catch (error) {\n      console.error('[BotBuilderTours] Failed to auto-start tours:', error);\n    }\n  }\n\n  _applyTheme(theme) {\n    document.documentElement.setAttribute('data-botbuilder-theme', theme);\n  }\n}\n\n// Create singleton instance\nconst instance = new TourSDK();\n\n// Export as global for UMD\nif (typeof window !== 'undefined') {\n  window.BotBuilderTours = instance;\n}\n\nexport default instance;\nexport { TourSDK };\n","/**\n * BotBuilder Tours SDK\n * Entry point for the SDK\n *\n * Usage:\n * <script src=\"https://yourdomain.com/tours-sdk.min.js\"></script>\n * <script>\n *   BotBuilderTours.init({ apiKey: 'xxx' });\n *   BotBuilderTours.startTour('tour-id');\n * </script>\n *\n * SDK Methods:\n * - init(config)        Initialize the SDK\n * - startTour(tourId)   Start a specific tour\n * - stopTour()          Stop the current tour\n * - nextStep()          Go to next step\n * - prevStep()          Go to previous step\n * - goToStep(index)     Go to a specific step\n * - onComplete(cb)      Register completion callback\n * - onSkip(cb)          Register skip callback\n */\n\nimport TourSDKInstance, { TourSDK } from './TourSDK';\nimport { TourEngine } from './TourEngine';\nimport { TourRenderer } from './TourRenderer';\nimport { EventEmitter, EVENTS } from './utils/events';\n\n// SDK instance (singleton)\nconst sdk = TourSDKInstance;\n\n// ==========================================\n// PUBLIC API METHODS\n// ==========================================\n\n/**\n * Initialize the SDK\n * @param {Object} config - Configuration object\n * @param {string} config.apiKey - API key (alias for workspaceId)\n * @param {string} [config.workspaceId] - Workspace ID\n * @param {string} [config.userId] - User ID for targeting\n * @param {boolean} [config.autoStart=true] - Auto start tours\n * @param {string} [config.theme='light'] - Theme: 'light' or 'dark'\n */\nfunction init(config) {\n  // Support apiKey as alias for workspaceId\n  const normalizedConfig = {\n    ...config,\n    workspaceId: config.workspaceId || config.apiKey\n  };\n  return sdk.init(normalizedConfig);\n}\n\n/**\n * Start a specific tour\n * @param {string} tourId - Tour ID to start\n */\nfunction startTour(tourId) {\n  return sdk.startTour(tourId);\n}\n\n/**\n * Stop the current tour\n * Alias for endTour(false)\n */\nfunction stopTour() {\n  return sdk.endTour(false);\n}\n\n/**\n * Go to the next step\n */\nfunction nextStep() {\n  return sdk.nextStep();\n}\n\n/**\n * Go to the previous step\n */\nfunction prevStep() {\n  return sdk.prevStep();\n}\n\n/**\n * Go to a specific step\n * @param {number} index - Step index (0-based)\n */\nfunction goToStep(index) {\n  return sdk.goToStep(index);\n}\n\n/**\n * Register a callback for tour completion\n * @param {Function} callback - Callback function\n */\nfunction onComplete(callback) {\n  sdk.on('tour:completed', callback);\n  return sdk;\n}\n\n/**\n * Register a callback for tour skip\n * @param {Function} callback - Callback function\n */\nfunction onSkip(callback) {\n  sdk.on('tour:dismissed', callback);\n  return sdk;\n}\n\n/**\n * Register a callback for step viewed\n * @param {Function} callback - Callback function\n */\nfunction onStepViewed(callback) {\n  sdk.on('step:viewed', callback);\n  return sdk;\n}\n\n/**\n * Register a callback for step completed\n * @param {Function} callback - Callback function\n */\nfunction onStepComplete(callback) {\n  sdk.on('step:completed', callback);\n  return sdk;\n}\n\n/**\n * Register a callback for tour started\n * @param {Function} callback - Callback function\n */\nfunction onStart(callback) {\n  sdk.on('tour:started', callback);\n  return sdk;\n}\n\n/**\n * Identify a user\n * @param {string} userId - User ID\n * @param {Object} [traits] - User traits for targeting\n */\nfunction identify(userId, traits) {\n  return sdk.identify(userId, traits);\n}\n\n/**\n * Get current tour state\n */\nfunction getState() {\n  return sdk.getState();\n}\n\n/**\n * Reset progress for a tour\n * @param {string} tourId - Tour ID\n */\nfunction resetProgress(tourId) {\n  return sdk.resetProgress(tourId);\n}\n\n/**\n * Destroy the SDK instance\n */\nfunction destroy() {\n  return sdk.destroy();\n}\n\n/**\n * End tour (alias with completion status)\n * @param {boolean} [completed=true] - Whether tour was completed\n */\nfunction endTour(completed = true) {\n  return sdk.endTour(completed);\n}\n\n/**\n * Skip current tour\n */\nfunction skipTour() {\n  return sdk.skipTour();\n}\n\n// ==========================================\n// EXPORTS\n// ==========================================\n\n// Named exports for direct access\nexport {\n  // Core API methods\n  init,\n  startTour,\n  stopTour,\n  nextStep,\n  prevStep,\n  goToStep,\n  onComplete,\n  onSkip,\n  onStepViewed,\n  onStepComplete,\n  onStart,\n  identify,\n  getState,\n  resetProgress,\n  destroy,\n  endTour,\n  skipTour,\n\n  // Classes for advanced usage\n  TourSDK,\n  TourEngine,\n  TourRenderer,\n  EventEmitter,\n  EVENTS\n};\n\n// Export utilities for custom implementations\nexport * from './utils/dom';\nexport * from './utils/positioning';\nexport * from './utils/storage';\nexport * from './utils/api';\nexport * from './utils/events';\n\n// Export components for custom rendering\nexport { Tooltip } from './components/Tooltip';\nexport { Modal } from './components/Modal';\nexport { Hotspot } from './components/Hotspot';\nexport { Slideout } from './components/Slideout';\nexport { Overlay, Highlight } from './components/Overlay';\nexport { ProgressBar, ProgressDots } from './components/ProgressBar';\n\n// Default export - SDK instance with all methods\nexport default {\n  // SDK instance\n  sdk,\n\n  // Public API methods\n  init,\n  startTour,\n  stopTour,\n  nextStep,\n  prevStep,\n  goToStep,\n  onComplete,\n  onSkip,\n  onStepViewed,\n  onStepComplete,\n  onStart,\n  identify,\n  getState,\n  resetProgress,\n  destroy,\n  endTour,\n  skipTour,\n\n  // Classes\n  TourSDK,\n  TourEngine,\n  TourRenderer,\n  EventEmitter,\n  EVENTS\n};\n"],"names":["API_URL","WORKSPACE_ID","initApi","apiUrl","workspaceId","async","request","endpoint","options","url","defaultHeaders","response","fetch","headers","ok","errorData","json","catch","Error","message","status","error","console","fetchActiveTours","visitorId","userId","params","URLSearchParams","window","location","pathname","append","toString","tours","fetchTour","tourId","tour","trackEvent","eventData","payload","timestamp","Date","toISOString","sessionId","getSessionId","pageUrl","href","pageTitle","document","title","navigator","sendBeacon","blob","Blob","JSON","stringify","type","method","body","syncProgress","progressData","batchTrackEvents","events","now","Math","random","substring","eventQueue","isOnline","onLine","flushEventQueue","length","push","addEventListener","STORAGE_PREFIX","VISITOR_ID_KEY","PROGRESS_KEY","SESSION_KEY","generateVisitorId","getVisitorId","localStorage","getItem","setItem","warn","setVisitorId","getProgress","data","parse","setProgress","clearProgress","removeItem","getSession","sessionStorage","setSession","existing","TourEngine","constructor","sdk","this","toursCache","Map","activeToursCache","lastFetch","cacheDuration","loadActiveTours","config","forEach","set","id","loadTour","has","get","checkTargeting","targeting","rules","context","hostname","search","hash","referrer","userTraits","device","_getDeviceInfo","operator","every","rule","_evaluateRule","some","shouldShowTour","startDate","endDate","progress","getUserProgress","settings","allowReplay","skipCooldown","cooldownEnd","updatedAt","getTime","currentUrl","pageUrlMatch","includes","RegExp","test","eventType","apiTrackEvent","userAgent","saveProgress","currentStep","clearCache","clear","field","value","fieldValue","_getUrlField","_getUserField","_compareValues","targetValue","strValue","String","toLowerCase","strTarget","startsWith","endsWith","Number","Array","isArray","split","map","v","trim","ua","_getDeviceType","browser","_getBrowser","os","_getOS","screenWidth","screen","width","screenHeight","height","language","SPACING","calculatePosition","targetRect","tooltipRect","preferredPosition","positions","top","left","bottom","right","viewportWidth","innerWidth","viewportHeight","innerHeight","fits","position","actualPosition","adjustForViewport","dimensions","padding","getArrowPosition","Tooltip","content","targetElement","media","buttons","stepIndex","totalSteps","showBackButton","showSkipButton","onNext","onPrev","onSkip","onClose","theme","primaryColor","element","arrowElement","_resizeHandler","_scrollHandler","render","container","_createTooltip","appendChild","_positionTooltip","_setupListeners","_animateIn","destroy","_removeListeners","parentNode","classList","add","setTimeout","removeChild","createElement","className","style","setProperty","wrapper","closeBtn","innerHTML","setAttribute","onclick","e","preventDefault","mediaEl","_createMedia","header","titleEl","textContent","contentEl","footer","actions","btn","button","variant","text","action","onClick","skipBtn","backBtn","nextBtn","img","src","alt","video","controls","autoplay","muted","loop","iframe","allowFullscreen","transform","display","getBoundingClientRect","adjusted","arrowPosition","_keyHandler","key","removeEventListener","requestAnimationFrame","Modal","size","closeOnBackdrop","closeOnEscape","backdropElement","_createBackdrop","_createModal","focus","target","i","dot","lottieContainer","Hotspot","color","pulse","triggerOn","hotspotElement","tooltipElement","isTooltipVisible","_createHotspot","_positionHotspot","backgroundColor","ring","borderColor","arrow","stopPropagation","hotspotRect","querySelector","_showTooltip","_hideTooltip","remove","_toggleTooltip","onmouseenter","onmouseleave","matches","_clickOutsideHandler","contains","Slideout","showOverlay","closeOnOverlay","overlayElement","_createOverlay","_createSlideout","progressBar","progressFill","progressText","buttonGroup","Overlay","opacity","borderRadius","spotlightElement","_updateSpotlight","svg","createElementNS","defs","mask","maskRect","overlayRect","tagName","rect","ProgressBar","current","total","showStepNumbers","_createProgressBar","update","_updateProgress","track","step","connector","querySelectorAll","toggle","findElement","selector","replace","isElementVisible","getComputedStyle","visibility","parseFloat","documentElement","clientHeight","clientWidth","isElementFullyVisible","scrollToElement","Promise","resolve","behavior","block","inline","offset","scrollIntoView","scrollBy","waitForElement","timeout","startTime","observer","MutationObserver","mutations","obs","disconnect","observe","childList","subtree","attributes","getFocusableElements","focusableSelectors","join","from","TourRenderer","currentComponent","overlay","hotspots","_createContainer","renderStep","_cleanup","targetSelector","waitTimeout","scrollTo","scrollBehavior","scrollBlock","overlayClickClose","overlayPadding","overlayOpacity","showProgress","componentOptions","_renderTooltip","_renderModal","_renderHotspot","_renderSlideout","_setupStepTriggers","rest","hotspotColor","slidePosition","slideWidth","trigger","event","clickHandler","_triggerCleanup","inputHandler","customHandler","getElementById","hotspot","EventEmitter","_events","_onceEvents","on","callback","once","off","filter","cb","removeAllListeners","emit","args","hasListeners","callbacks","listenerCount","eventNames","Set","Object","keys","listeners","EVENTS","SDK_INITIALIZED","SDK_DESTROYED","USER_IDENTIFIED","TOUR_STARTED","TOUR_COMPLETED","TOUR_DISMISSED","TOUR_ERROR","STEP_VIEWED","STEP_COMPLETED","STEP_SKIPPED","PROGRESS_SAVED","PROGRESS_RESET","TourSDK","super","engine","renderer","currentTour","currentStepIndex","initialized","init","autoStart","_applyTheme","_autoStartTours","identify","traits","startTour","_showCurrentStep","endTour","completed","completedSteps","steps","nextStep","prevStep","skipTour","goToStep","getState","resetProgress","stepId","instance","BotBuilderTours","TourSDKInstance","normalizedConfig","apiKey","stopTour","index","onComplete","onStepViewed","onStepComplete","onStart","borderWidth","_createHighlight","_updatePosition","border","boxShadow","_createDots","_updateDots","tooltipCenter","direction","modalSize","alignment","side","overflowTop","overflowRight","overflowBottom","overflowLeft","focusableElements","firstElement","lastElement","handleKeyDown","shiftKey","activeElement","emitter","func","wait","clearTimeout","later","dismissed","scrollLeft","pageXOffset","scrollTop","pageYOffset","absoluteTop","absoluteLeft","centerX","centerY","tooltipSize","spaceAbove","spaceBelow","spaceLeft","spaceRight","spaces","space","fittingPositions","entries","sort","a","b","totalSize","tourDataSize","hasOwnProperty","totalSizeKB","toFixed","tourDataSizeKB","el","zIndex","z","parseInt","isNaN","parentElement","seen","duration","originalOutline","outline","originalTransition","transition","cleanup","session","seenAt","queuedAt","limit","inThrottle"],"mappings":"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"}